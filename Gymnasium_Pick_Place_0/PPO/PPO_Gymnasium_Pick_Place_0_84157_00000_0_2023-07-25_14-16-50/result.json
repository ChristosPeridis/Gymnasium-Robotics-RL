{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27213543976292853, "mean_inference_ms": 0.7475036677668997, "mean_action_processing_ms": 0.11258231781061799, "mean_env_wait_ms": 1.1985945197030556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01811981201171875, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.14003515243530273}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27213543976292853, "mean_inference_ms": 0.7475036677668997, "mean_action_processing_ms": 0.11258231781061799, "mean_env_wait_ms": 1.1985945197030556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01811981201171875, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.14003515243530273}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.954142794013023}, "default_policy": {"total_loss": 9.954142794013023, "policy_loss": 0.012804611236788332, "vf_loss": 9.939378194510937, "vf_loss_unclipped": 2036.4264620542526, "vf_explained_var": -0.16910180961713195, "entropy": 5.236424174159765, "mean_kl_loss": 0.013727750474572713, "gradients_default_optimizer_global_norm": 1.935212028445676, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 0, "num_env_steps_sampled": 512, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 235.50453329116334, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 512, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 512, "timers": {"training_iteration_time_ms": 2174.024, "sample_time_ms": 1229.635, "synch_weights_time_ms": 0.674}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "84157_00000", "date": "2023-07-25_14-17-09", "timestamp": 1690291029, "time_this_iter_s": 16.22188377380371, "time_total_s": 16.22188377380371, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 16.22188377380371, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 6.141666666666667, "ram_util_percent": 75.96666666666665}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26907621647018104, "mean_inference_ms": 0.7345482524499606, "mean_action_processing_ms": 0.11140204957997477, "mean_env_wait_ms": 1.1946166041453434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018918514251708984, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.13979673385620117}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26907621647018104, "mean_inference_ms": 0.7345482524499606, "mean_action_processing_ms": 0.11140204957997477, "mean_env_wait_ms": 1.1946166041453434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018918514251708984, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.13979673385620117}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.935276225209236}, "default_policy": {"total_loss": 9.935276225209236, "policy_loss": 0.00567668690928258, "vf_loss": 9.929670326411724, "vf_loss_unclipped": 1870.9182349443436, "vf_explained_var": -0.3798610595986247, "entropy": 5.176284946501255, "mean_kl_loss": 0.0035282276478483254, "gradients_default_optimizer_global_norm": 2.0724352325778455, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 335.13210750776545, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1024, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 1850.879, "sample_time_ms": 1184.863, "synch_weights_time_ms": 0.656}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "84157_00000", "date": "2023-07-25_14-17-25", "timestamp": 1690291045, "time_this_iter_s": 15.318389415740967, "time_total_s": 31.540273189544678, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 31.540273189544678, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 6.704761904761905, "ram_util_percent": 76.34761904761906}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26528513846771695, "mean_inference_ms": 0.720046757393483, "mean_action_processing_ms": 0.10956731692108007, "mean_env_wait_ms": 1.183715928071711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018477439880371094, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.13953447341918945}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26528513846771695, "mean_inference_ms": 0.720046757393483, "mean_action_processing_ms": 0.10956731692108007, "mean_env_wait_ms": 1.183715928071711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018477439880371094, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.13953447341918945}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.931903172284365}, "default_policy": {"total_loss": 9.931903172284365, "policy_loss": 0.007794067758368328, "vf_loss": 9.924096122384071, "vf_loss_unclipped": 1729.851167678833, "vf_explained_var": -0.40840893518179655, "entropy": 5.22930371016264, "mean_kl_loss": 0.007973919387438855, "gradients_default_optimizer_global_norm": 1.7779998646583408, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1536, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 347.06525975547675, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1536, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1536, "timers": {"training_iteration_time_ms": 1725.655, "sample_time_ms": 1161.216, "synch_weights_time_ms": 0.634}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "84157_00000", "date": "2023-07-25_14-17-39", "timestamp": 1690291059, "time_this_iter_s": 14.832229375839233, "time_total_s": 46.37250256538391, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 46.37250256538391, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 6.214285714285714, "ram_util_percent": 76.92857142857143}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26729095876676323, "mean_inference_ms": 0.7260580330281242, "mean_action_processing_ms": 0.1103929080425126, "mean_env_wait_ms": 1.1820698980440534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019669532775878906, "StateBufferConnector_ms": 0.0029087066650390625, "ViewRequirementAgentConnector_ms": 0.14470815658569336}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26729095876676323, "mean_inference_ms": 0.7260580330281242, "mean_action_processing_ms": 0.1103929080425126, "mean_env_wait_ms": 1.1820698980440534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019669532775878906, "StateBufferConnector_ms": 0.0029087066650390625, "ViewRequirementAgentConnector_ms": 0.14470815658569336}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.940369628369808}, "default_policy": {"total_loss": 9.940369628369808, "policy_loss": 0.008858115266775712, "vf_loss": 9.931468956172466, "vf_loss_unclipped": 1643.386921286583, "vf_explained_var": -0.389127001632005, "entropy": 5.311433602124453, "mean_kl_loss": 0.008393157565933507, "gradients_default_optimizer_global_norm": 1.9192083559464663, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 0, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 353.0392924627715, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 2048, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 1656.801, "sample_time_ms": 1144.773, "synch_weights_time_ms": 0.628}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "84157_00000", "date": "2023-07-25_14-17-55", "timestamp": 1690291075, "time_this_iter_s": 15.356980323791504, "time_total_s": 61.729482889175415, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 61.729482889175415, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 10.136363636363637, "ram_util_percent": 80.7818181818182}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2995.0, "episode_reward_min": -3000.0, "episode_reward_mean": -2997.5, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2995.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26887910556230565, "mean_inference_ms": 0.7301953342659371, "mean_action_processing_ms": 0.11097833731266575, "mean_env_wait_ms": 1.184638669214973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018608570098876953, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.14083385467529297}}, "episode_reward_max": -2995.0, "episode_reward_min": -3000.0, "episode_reward_mean": -2997.5, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2995.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26887910556230565, "mean_inference_ms": 0.7301953342659371, "mean_action_processing_ms": 0.11097833731266575, "mean_env_wait_ms": 1.184638669214973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018608570098876953, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.14083385467529297}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.9432124607265}, "default_policy": {"total_loss": 9.9432124607265, "policy_loss": 0.009487070055911317, "vf_loss": 9.933962441980839, "vf_loss_unclipped": 1561.3649079799652, "vf_explained_var": -0.39758563693612814, "entropy": 5.388515651226044, "mean_kl_loss": 0.005712612609841017, "gradients_default_optimizer_global_norm": 1.8009431019891053, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 0, "num_env_steps_sampled": 2560, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 352.5786043658676, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 2560, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2560, "timers": {"training_iteration_time_ms": 1615.869, "sample_time_ms": 1136.778, "synch_weights_time_ms": 0.63}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "84157_00000", "date": "2023-07-25_14-18-10", "timestamp": 1690291090, "time_this_iter_s": 15.508189678192139, "time_total_s": 77.23767256736755, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 77.23767256736755, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.149999999999999, "ram_util_percent": 84.94999999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2670827757891362, "mean_inference_ms": 0.7261469848871013, "mean_action_processing_ms": 0.11020737063079764, "mean_env_wait_ms": 1.1706673427772623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014269351959228516, "StateBufferConnector_ms": 0.002968311309814453, "ViewRequirementAgentConnector_ms": 0.1408219337463379}}, "episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2670827757891362, "mean_inference_ms": 0.7261469848871013, "mean_action_processing_ms": 0.11020737063079764, "mean_env_wait_ms": 1.1706673427772623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014269351959228516, "StateBufferConnector_ms": 0.002968311309814453, "ViewRequirementAgentConnector_ms": 0.1408219337463379}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.836567796766758}, "default_policy": {"total_loss": 9.836567796766758, "policy_loss": -0.0015608922112733126, "vf_loss": 9.83822676539421, "vf_loss_unclipped": 1257.7408860325813, "vf_explained_var": -0.06610252102836967, "entropy": 5.384881477802992, "mean_kl_loss": 0.007097095383926444, "gradients_default_optimizer_global_norm": 2.2600132576189935, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 0, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 357.7571840605175, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 3072, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 1585.076, "sample_time_ms": 1128.081, "synch_weights_time_ms": 0.639}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 6, "trial_id": "84157_00000", "date": "2023-07-25_14-18-25", "timestamp": 1690291105, "time_this_iter_s": 14.515695571899414, "time_total_s": 91.75336813926697, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 91.75336813926697, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 6.223809523809523, "ram_util_percent": 88.96190476190475}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2655389663653784, "mean_inference_ms": 0.7207500932046407, "mean_action_processing_ms": 0.1096406387932536, "mean_env_wait_ms": 1.1622832107026249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013124942779541016, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.13668537139892578}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2655389663653784, "mean_inference_ms": 0.7207500932046407, "mean_action_processing_ms": 0.1096406387932536, "mean_env_wait_ms": 1.1622832107026249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013124942779541016, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.13668537139892578}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.940138284116983}, "default_policy": {"total_loss": 9.940138284116983, "policy_loss": 0.002985985658597201, "vf_loss": 9.937352418899536, "vf_loss_unclipped": 1388.3791823983192, "vf_explained_var": -0.16000570077449083, "entropy": 5.379786796867847, "mean_kl_loss": 0.00606899202182376, "gradients_default_optimizer_global_norm": 1.8501600386807695, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 0, "num_env_steps_sampled": 3584, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 346.2582537067652, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 3584, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3584, "timers": {"training_iteration_time_ms": 1569.872, "sample_time_ms": 1128.198, "synch_weights_time_ms": 0.647}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 7, "trial_id": "84157_00000", "date": "2023-07-25_14-18-39", "timestamp": 1690291119, "time_this_iter_s": 14.51417851448059, "time_total_s": 106.26754665374756, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 106.26754665374756, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 6.185714285714285, "ram_util_percent": 89.09523809523807}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2653433236948453, "mean_inference_ms": 0.7183673230263768, "mean_action_processing_ms": 0.10940710759824004, "mean_env_wait_ms": 1.15521080143608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015747547149658203, "StateBufferConnector_ms": 0.003230571746826172, "ViewRequirementAgentConnector_ms": 0.16455650329589844}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2653433236948453, "mean_inference_ms": 0.7183673230263768, "mean_action_processing_ms": 0.10940710759824004, "mean_env_wait_ms": 1.15521080143608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015747547149658203, "StateBufferConnector_ms": 0.003230571746826172, "ViewRequirementAgentConnector_ms": 0.16455650329589844}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.939609237015247}, "default_policy": {"total_loss": 9.939609237015247, "policy_loss": 0.002932192903244868, "vf_loss": 9.93682810664177, "vf_loss_unclipped": 1341.4317572712898, "vf_explained_var": -0.1129836579784751, "entropy": 5.356711067259312, "mean_kl_loss": 0.006523708424310826, "gradients_default_optimizer_global_norm": 1.6063476821873337, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 357.22586478012266, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4096, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 1552.794, "sample_time_ms": 1122.736, "synch_weights_time_ms": 0.642}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 8, "trial_id": "84157_00000", "date": "2023-07-25_14-18-54", "timestamp": 1690291134, "time_this_iter_s": 14.567882061004639, "time_total_s": 120.8354287147522, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 120.8354287147522, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 6.576190476190476, "ram_util_percent": 89.17142857142858}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2644941569747723, "mean_inference_ms": 0.7162082416256592, "mean_action_processing_ms": 0.10915027366996052, "mean_env_wait_ms": 1.1478966226074616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013077259063720703, "StateBufferConnector_ms": 0.002753734588623047, "ViewRequirementAgentConnector_ms": 0.13474225997924805}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2644941569747723, "mean_inference_ms": 0.7162082416256592, "mean_action_processing_ms": 0.10915027366996052, "mean_env_wait_ms": 1.1478966226074616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013077259063720703, "StateBufferConnector_ms": 0.002753734588623047, "ViewRequirementAgentConnector_ms": 0.13474225997924805}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.937088340520859}, "default_policy": {"total_loss": 9.937088340520859, "policy_loss": 0.0024431596975773573, "vf_loss": 9.934901967644691, "vf_loss_unclipped": 1290.0683937072754, "vf_explained_var": -0.23690348071977496, "entropy": 5.322243470698595, "mean_kl_loss": 0.005415366460738369, "gradients_default_optimizer_global_norm": 1.59264763770625, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4608, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 346.8309020530769, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4608, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4608, "timers": {"training_iteration_time_ms": 1544.283, "sample_time_ms": 1122.304, "synch_weights_time_ms": 0.638}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 9, "trial_id": "84157_00000", "date": "2023-07-25_14-19-09", "timestamp": 1690291149, "time_this_iter_s": 14.453879594802856, "time_total_s": 135.28930830955505, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 135.28930830955505, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 8.270000000000001, "ram_util_percent": 75.41499999999999}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2647829589040134, "mean_inference_ms": 0.7176487881454519, "mean_action_processing_ms": 0.10938882505899071, "mean_env_wait_ms": 1.1472792107352308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012743473052978516, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.1382589340209961}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2647829589040134, "mean_inference_ms": 0.7176487881454519, "mean_action_processing_ms": 0.10938882505899071, "mean_env_wait_ms": 1.1472792107352308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012743473052978516, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.1382589340209961}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.93151805177331}, "default_policy": {"total_loss": 9.93151805177331, "policy_loss": -0.00235745232203044, "vf_loss": 9.934156887233257, "vf_loss_unclipped": 1242.8928376436234, "vf_explained_var": -0.12877538288012147, "entropy": 5.285861622542143, "mean_kl_loss": 0.0051151535512872215, "gradients_default_optimizer_global_norm": 1.4965793413575739, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 0, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 362.6135948291161, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 5120, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 1531.05, "sample_time_ms": 1116.289, "synch_weights_time_ms": 0.635}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 10, "trial_id": "84157_00000", "date": "2023-07-25_14-19-24", "timestamp": 1690291164, "time_this_iter_s": 14.98121190071106, "time_total_s": 150.2705202102661, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 150.2705202102661, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 7.833333333333332, "ram_util_percent": 69.4047619047619}}
{"evaluation": {"sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, 0.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2651446223361924, "mean_inference_ms": 0.7186738348854659, "mean_action_processing_ms": 0.10956214580771992, "mean_env_wait_ms": 1.1455921441796595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013518333435058594, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.1443028450012207}}, "episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, 0.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2651446223361924, "mean_inference_ms": 0.7186738348854659, "mean_action_processing_ms": 0.10956214580771992, "mean_env_wait_ms": 1.1455921441796595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013518333435058594, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.1443028450012207}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.93423392251134}, "default_policy": {"total_loss": 9.93423392251134, "policy_loss": 0.0011027407308574766, "vf_loss": 9.933438241481781, "vf_loss_unclipped": 1196.7194361686707, "vf_explained_var": -0.18562533613294363, "entropy": 5.197509683668613, "mean_kl_loss": 0.004725729559481806, "gradients_default_optimizer_global_norm": 1.7674149906961247, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0], "episode_lengths": [3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723487424493575, "mean_inference_ms": 0.7162435490030673, "mean_action_processing_ms": 0.11083290703398298, "mean_env_wait_ms": 1.0972370590870364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747608184814453, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.1281261444091797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 0, "num_env_steps_sampled": 5632, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 344.36523550752526, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 5632, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 5632, "timers": {"training_iteration_time_ms": 1462.325, "sample_time_ms": 1107.252, "synch_weights_time_ms": 0.638}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1, "training_iteration": 11, "trial_id": "84157_00000", "date": "2023-07-25_14-19-39", "timestamp": 1690291179, "time_this_iter_s": 14.973927021026611, "time_total_s": 165.24444723129272, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 165.24444723129272, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 11.109090909090908, "ram_util_percent": 74.57727272727274}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26583692100027834, "mean_inference_ms": 0.7200919380304017, "mean_action_processing_ms": 0.1098140028009441, "mean_env_wait_ms": 1.1429707309712676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05086660385131836, "StateBufferConnector_ms": 0.003147125244140625, "ViewRequirementAgentConnector_ms": 0.18252134323120117}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26583692100027834, "mean_inference_ms": 0.7200919380304017, "mean_action_processing_ms": 0.1098140028009441, "mean_env_wait_ms": 1.1429707309712676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05086660385131836, "StateBufferConnector_ms": 0.003147125244140625, "ViewRequirementAgentConnector_ms": 0.18252134323120117}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.831174198538065}, "default_policy": {"total_loss": 9.831174198538065, "policy_loss": 0.0027765777485910803, "vf_loss": 9.828828670084476, "vf_loss_unclipped": 931.0536978840828, "vf_explained_var": 0.01770196668803692, "entropy": 5.3581193052232265, "mean_kl_loss": 0.007454419356690778, "gradients_default_optimizer_global_norm": 2.10531357396394, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 0, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 336.7115516382259, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 6144, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 1461.608, "sample_time_ms": 1109.03, "synch_weights_time_ms": 0.635}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 12, "trial_id": "84157_00000", "date": "2023-07-25_14-19-54", "timestamp": 1690291194, "time_this_iter_s": 14.997742891311646, "time_total_s": 180.24219012260437, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 180.24219012260437, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 11.319047619047618, "ram_util_percent": 89.44285714285714}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26693032158669583, "mean_inference_ms": 0.7234102817601472, "mean_action_processing_ms": 0.11022930776392353, "mean_env_wait_ms": 1.143279921508606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013995170593261719, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.14530420303344727}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26693032158669583, "mean_inference_ms": 0.7234102817601472, "mean_action_processing_ms": 0.11022930776392353, "mean_env_wait_ms": 1.143279921508606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013995170593261719, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.14530420303344727}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.934120055288076}, "default_policy": {"total_loss": 9.934120055288076, "policy_loss": 0.004264066752512008, "vf_loss": 9.93027464300394, "vf_loss_unclipped": 1069.265538930893, "vf_explained_var": -0.2130432748235762, "entropy": 5.177192568778992, "mean_kl_loss": 0.007157574573511738, "gradients_default_optimizer_global_norm": 1.609307871782221, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 0, "num_env_steps_sampled": 6656, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 332.63769028259935, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 6656, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 6656, "timers": {"training_iteration_time_ms": 1468.007, "sample_time_ms": 1115.562, "synch_weights_time_ms": 0.643}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 13, "trial_id": "84157_00000", "date": "2023-07-25_14-20-09", "timestamp": 1690291209, "time_this_iter_s": 15.435954093933105, "time_total_s": 195.67814421653748, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 195.67814421653748, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.536363636363637, "ram_util_percent": 91.75454545454545}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2669955041853837, "mean_inference_ms": 0.7231238427581499, "mean_action_processing_ms": 0.11025325617428797, "mean_env_wait_ms": 1.1454225516024379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014483928680419922, "StateBufferConnector_ms": 0.004029273986816406, "ViewRequirementAgentConnector_ms": 0.15056133270263672}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2669955041853837, "mean_inference_ms": 0.7231238427581499, "mean_action_processing_ms": 0.11025325617428797, "mean_env_wait_ms": 1.1454225516024379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014483928680419922, "StateBufferConnector_ms": 0.004029273986816406, "ViewRequirementAgentConnector_ms": 0.15056133270263672}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.930690128356218}, "default_policy": {"total_loss": 9.930690128356218, "policy_loss": 0.0008811731240712106, "vf_loss": 9.930367887020111, "vf_loss_unclipped": 1035.283252120018, "vf_explained_var": -0.11660236120223999, "entropy": 5.174438733607531, "mean_kl_loss": 0.004344402430660921, "gradients_default_optimizer_global_norm": 1.6625339776510373, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 0, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 346.2993497263045, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 7168, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 1470.829, "sample_time_ms": 1118.45, "synch_weights_time_ms": 0.656}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 14, "trial_id": "84157_00000", "date": "2023-07-25_14-20-24", "timestamp": 1690291224, "time_this_iter_s": 15.165608882904053, "time_total_s": 210.84375309944153, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 210.84375309944153, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 11.322727272727272, "ram_util_percent": 92.34545454545454}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26692834276989885, "mean_inference_ms": 0.7227112709925578, "mean_action_processing_ms": 0.11025307063289438, "mean_env_wait_ms": 1.1449885595372116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013935565948486328, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.1366138458251953}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26692834276989885, "mean_inference_ms": 0.7227112709925578, "mean_action_processing_ms": 0.11025307063289438, "mean_env_wait_ms": 1.1449885595372116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013935565948486328, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.1366138458251953}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.929822415113449}, "default_policy": {"total_loss": 9.929822415113449, "policy_loss": 0.0020021710952278227, "vf_loss": 9.928532220423222, "vf_loss_unclipped": 998.1204572916031, "vf_explained_var": -0.178811255376786, "entropy": 5.217032082378864, "mean_kl_loss": 0.002821978335646236, "gradients_default_optimizer_global_norm": 1.5538106620078906, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.012500000186264515}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 0, "num_env_steps_sampled": 7680, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 356.13303871771893, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 7680, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 7680, "timers": {"training_iteration_time_ms": 1469.379, "sample_time_ms": 1117.723, "synch_weights_time_ms": 0.651}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 15, "trial_id": "84157_00000", "date": "2023-07-25_14-20-39", "timestamp": 1690291239, "time_this_iter_s": 14.89064359664917, "time_total_s": 225.7343966960907, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 225.7343966960907, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 11.366666666666665, "ram_util_percent": 92.27619047619048}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2671052582049049, "mean_inference_ms": 0.7228207197541093, "mean_action_processing_ms": 0.11029198368860196, "mean_env_wait_ms": 1.1462854845578645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0141143798828125, "StateBufferConnector_ms": 0.003325939178466797, "ViewRequirementAgentConnector_ms": 0.1518845558166504}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2671052582049049, "mean_inference_ms": 0.7228207197541093, "mean_action_processing_ms": 0.11029198368860196, "mean_env_wait_ms": 1.1462854845578645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0141143798828125, "StateBufferConnector_ms": 0.003325939178466797, "ViewRequirementAgentConnector_ms": 0.1518845558166504}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.923418316990137}, "default_policy": {"total_loss": 9.923418316990137, "policy_loss": -0.0015525930211879313, "vf_loss": 9.925671860575676, "vf_loss_unclipped": 959.1010973453522, "vf_explained_var": -0.16847679484635592, "entropy": 5.248644299805164, "mean_kl_loss": 0.006906394132442983, "gradients_default_optimizer_global_norm": 1.4857332686660811, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.012500000186264515}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 349.86620232537757, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8192, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 1472.607, "sample_time_ms": 1121.389, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 16, "trial_id": "84157_00000", "date": "2023-07-25_14-20-54", "timestamp": 1690291254, "time_this_iter_s": 15.149906873703003, "time_total_s": 240.8843035697937, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 240.8843035697937, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 11.227272727272727, "ram_util_percent": 92.28636363636365}}
{"evaluation": {"sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26640625937583556, "mean_inference_ms": 0.7204992444074322, "mean_action_processing_ms": 0.10999910885282063, "mean_env_wait_ms": 1.145826131822717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012683868408203125, "StateBufferConnector_ms": 0.0025987625122070312, "ViewRequirementAgentConnector_ms": 0.13664960861206055}}, "episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26640625937583556, "mean_inference_ms": 0.7204992444074322, "mean_action_processing_ms": 0.10999910885282063, "mean_env_wait_ms": 1.145826131822717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012683868408203125, "StateBufferConnector_ms": 0.0025987625122070312, "ViewRequirementAgentConnector_ms": 0.13664960861206055}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.926185935735703}, "default_policy": {"total_loss": 9.926185935735703, "policy_loss": 0.002328912232769653, "vf_loss": 9.924602963030338, "vf_loss_unclipped": 923.7192460298538, "vf_explained_var": -0.1288815508596599, "entropy": 5.283592388033867, "mean_kl_loss": 0.003721363113982079, "gradients_default_optimizer_global_norm": 1.5801386516541243, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.0062500000931322575}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2675696081936314, "mean_inference_ms": 0.7142936408726822, "mean_action_processing_ms": 0.11033280741779848, "mean_env_wait_ms": 1.093350625682481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023508071899414062, "StateBufferConnector_ms": 0.003349781036376953, "ViewRequirementAgentConnector_ms": 0.18178224563598633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8704, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 344.2245884180648, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8704, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8704, "timers": {"training_iteration_time_ms": 1473.481, "sample_time_ms": 1121.955, "synch_weights_time_ms": 0.655}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 17, "trial_id": "84157_00000", "date": "2023-07-25_14-21-09", "timestamp": 1690291269, "time_this_iter_s": 14.639509677886963, "time_total_s": 255.52381324768066, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 255.52381324768066, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 7.764999999999999, "ram_util_percent": 73.91}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26594077119906656, "mean_inference_ms": 0.7180593217763954, "mean_action_processing_ms": 0.10969235260602875, "mean_env_wait_ms": 1.1454367145127864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012850761413574219, "StateBufferConnector_ms": 0.002682209014892578, "ViewRequirementAgentConnector_ms": 0.13598203659057617}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26594077119906656, "mean_inference_ms": 0.7180593217763954, "mean_action_processing_ms": 0.10969235260602875, "mean_env_wait_ms": 1.1454367145127864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012850761413574219, "StateBufferConnector_ms": 0.002682209014892578, "ViewRequirementAgentConnector_ms": 0.13598203659057617}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.803655747324228}, "default_policy": {"total_loss": 9.803655747324228, "policy_loss": -0.00036038990947417915, "vf_loss": 9.8047846108675, "vf_loss_unclipped": 704.4021652936935, "vf_explained_var": -0.003454224206507206, "entropy": 5.338371220976114, "mean_kl_loss": 0.005175836824719227, "gradients_default_optimizer_global_norm": 2.1103693526238203, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.0062500000931322575}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 0, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 348.69672458026173, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 9216, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 1476.987, "sample_time_ms": 1127.8, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 18, "trial_id": "84157_00000", "date": "2023-07-25_14-21-24", "timestamp": 1690291284, "time_this_iter_s": 14.593026399612427, "time_total_s": 270.1168396472931, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 270.1168396472931, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 6.180952380952381, "ram_util_percent": 67.8714285714286}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26590657800326484, "mean_inference_ms": 0.7178951291234625, "mean_action_processing_ms": 0.10969432803338275, "mean_env_wait_ms": 1.143826021324006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022113323211669922, "StateBufferConnector_ms": 0.0029802322387695312, "ViewRequirementAgentConnector_ms": 0.14939308166503906}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26590657800326484, "mean_inference_ms": 0.7178951291234625, "mean_action_processing_ms": 0.10969432803338275, "mean_env_wait_ms": 1.143826021324006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022113323211669922, "StateBufferConnector_ms": 0.0029802322387695312, "ViewRequirementAgentConnector_ms": 0.14939308166503906}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.921323902904987}, "default_policy": {"total_loss": 9.921323902904987, "policy_loss": 0.004256639018421993, "vf_loss": 9.917832903563976, "vf_loss_unclipped": 812.2324024438858, "vf_explained_var": -0.1291456911712885, "entropy": 5.340403988957405, "mean_kl_loss": 0.005670936627950596, "gradients_default_optimizer_global_norm": 1.521232459694147, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.0062500000931322575}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 0, "num_env_steps_sampled": 9728, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 354.63358071174963, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 9728, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 9728, "timers": {"training_iteration_time_ms": 1473.738, "sample_time_ms": 1126.861, "synch_weights_time_ms": 0.657}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 19, "trial_id": "84157_00000", "date": "2023-07-25_14-21-38", "timestamp": 1690291298, "time_this_iter_s": 14.732700824737549, "time_total_s": 284.84954047203064, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 284.84954047203064, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 6.128571428571429, "ram_util_percent": 67.87142857142858}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26604349242193615, "mean_inference_ms": 0.7188771800410118, "mean_action_processing_ms": 0.10986615258049323, "mean_env_wait_ms": 1.1447341931597288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012683868408203125, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.13312101364135742}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26604349242193615, "mean_inference_ms": 0.7188771800410118, "mean_action_processing_ms": 0.10986615258049323, "mean_env_wait_ms": 1.1447341931597288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012683868408203125, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.13312101364135742}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.91796650737524}, "default_policy": {"total_loss": 9.91796650737524, "policy_loss": -0.0001738404098432511, "vf_loss": 9.918914772570133, "vf_loss_unclipped": 783.5367599725723, "vf_explained_var": -0.010879997164011002, "entropy": 5.315369199961424, "mean_kl_loss": 0.003684578703087027, "gradients_default_optimizer_global_norm": 1.4604967539198697, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.0031250000465661287}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 0, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 370.1848280122845, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 10240, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 1470.85, "sample_time_ms": 1126.615, "synch_weights_time_ms": 0.66}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 20, "trial_id": "84157_00000", "date": "2023-07-25_14-21-54", "timestamp": 1690291314, "time_this_iter_s": 15.13292121887207, "time_total_s": 299.9824616909027, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 299.9824616909027, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 6.409090909090909, "ram_util_percent": 67.99545454545454}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2668871852973362, "mean_inference_ms": 0.7208750502096157, "mean_action_processing_ms": 0.1101168831876656, "mean_env_wait_ms": 1.1455308620803377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01766681671142578, "StateBufferConnector_ms": 0.00362396240234375, "ViewRequirementAgentConnector_ms": 0.1714468002319336}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2668871852973362, "mean_inference_ms": 0.7208750502096157, "mean_action_processing_ms": 0.1101168831876656, "mean_env_wait_ms": 1.1455308620803377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01766681671142578, "StateBufferConnector_ms": 0.00362396240234375, "ViewRequirementAgentConnector_ms": 0.1714468002319336}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.915956914424896}, "default_policy": {"total_loss": 9.915956914424896, "policy_loss": 0.0007011279521975666, "vf_loss": 9.9160420820117, "vf_loss_unclipped": 751.729799926281, "vf_explained_var": -0.005055817309767008, "entropy": 5.308227341622114, "mean_kl_loss": 0.0031978778213215264, "gradients_default_optimizer_global_norm": 1.555481394403614, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.0015625000232830644}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 0, "num_env_steps_sampled": 10752, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 353.49705455287096, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 10752, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1467.01, "sample_time_ms": 1123.314, "synch_weights_time_ms": 0.657}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 21, "trial_id": "84157_00000", "date": "2023-07-25_14-22-09", "timestamp": 1690291329, "time_this_iter_s": 15.439241170883179, "time_total_s": 315.4217028617859, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 315.4217028617859, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 9.186363636363636, "ram_util_percent": 70.22272727272727}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2669493182742353, "mean_inference_ms": 0.7209182873811569, "mean_action_processing_ms": 0.11016133328257036, "mean_env_wait_ms": 1.1477370082285827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012898445129394531, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.13495683670043945}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2669493182742353, "mean_inference_ms": 0.7209182873811569, "mean_action_processing_ms": 0.11016133328257036, "mean_env_wait_ms": 1.1477370082285827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012898445129394531, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.13495683670043945}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.913145519793034}, "default_policy": {"total_loss": 9.913145519793034, "policy_loss": -0.0008371045696549118, "vf_loss": 9.914775982499123, "vf_loss_unclipped": 721.6179991364479, "vf_explained_var": -0.02400906290858984, "entropy": 5.328979697078466, "mean_kl_loss": 0.0038467984120416077, "gradients_default_optimizer_global_norm": 1.4921835572458804, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.0007812500116415322}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 0, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 335.6958552071396, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 11264, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 1467.47, "sample_time_ms": 1124.444, "synch_weights_time_ms": 0.662}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 22, "trial_id": "84157_00000", "date": "2023-07-25_14-22-25", "timestamp": 1690291345, "time_this_iter_s": 15.356921195983887, "time_total_s": 330.7786240577698, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 330.7786240577698, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 11.3, "ram_util_percent": 73.41818181818182}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2669608373315302, "mean_inference_ms": 0.7209702678893295, "mean_action_processing_ms": 0.11018846317665844, "mean_env_wait_ms": 1.1464770433293758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01354217529296875, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.14078617095947266}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2669608373315302, "mean_inference_ms": 0.7209702678893295, "mean_action_processing_ms": 0.11018846317665844, "mean_env_wait_ms": 1.1464770433293758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01354217529296875, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.14078617095947266}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.912922572344542}, "default_policy": {"total_loss": 9.912922572344542, "policy_loss": 0.0022623977274633944, "vf_loss": 9.911461681127548, "vf_loss_unclipped": 690.6542012393475, "vf_explained_var": -0.12170858820900321, "entropy": 5.359485059976578, "mean_kl_loss": 0.0030328527810183914, "gradients_default_optimizer_global_norm": 1.5191152678453363, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.0003906250058207661}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26787296466432403, "mean_inference_ms": 0.7136847219231518, "mean_action_processing_ms": 0.11011920446846653, "mean_env_wait_ms": 1.094450437385145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021449724833170574, "StateBufferConnector_ms": 0.0031789143880208335, "ViewRequirementAgentConnector_ms": 0.16442139943440756}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 0, "num_env_steps_sampled": 11776, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 339.01445072926157, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 11776, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 11776, "timers": {"training_iteration_time_ms": 1464.574, "sample_time_ms": 1120.974, "synch_weights_time_ms": 0.661}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 3, "training_iteration": 23, "trial_id": "84157_00000", "date": "2023-07-25_14-22-39", "timestamp": 1690291359, "time_this_iter_s": 14.883682489395142, "time_total_s": 345.6623065471649, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 345.6623065471649, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 11.347619047619048, "ram_util_percent": 74.56666666666665}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2670979875820251, "mean_inference_ms": 0.721454117036712, "mean_action_processing_ms": 0.110235649079376, "mean_env_wait_ms": 1.147772848426883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015056133270263672, "StateBufferConnector_ms": 0.0029206275939941406, "ViewRequirementAgentConnector_ms": 0.1402139663696289}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2670979875820251, "mean_inference_ms": 0.721454117036712, "mean_action_processing_ms": 0.110235649079376, "mean_env_wait_ms": 1.147772848426883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015056133270263672, "StateBufferConnector_ms": 0.0029206275939941406, "ViewRequirementAgentConnector_ms": 0.1402139663696289}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.777235634624958}, "default_policy": {"total_loss": 9.777235634624958, "policy_loss": -0.0021343561238609254, "vf_loss": 9.780166000127792, "vf_loss_unclipped": 524.3352738320827, "vf_explained_var": -0.016480294056236744, "entropy": 5.318515859544277, "mean_kl_loss": 0.004639921196940122, "gradients_default_optimizer_global_norm": 2.1482107072370127, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.00019531250291038305}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 325.8781626735476, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12288, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 1473.838, "sample_time_ms": 1129.804, "synch_weights_time_ms": 0.651}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 24, "trial_id": "84157_00000", "date": "2023-07-25_14-22-55", "timestamp": 1690291375, "time_this_iter_s": 15.382338762283325, "time_total_s": 361.04464530944824, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 361.04464530944824, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 11.472727272727274, "ram_util_percent": 75.83636363636366}}
{"evaluation": {"sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2672162218315314, "mean_inference_ms": 0.7216551083868221, "mean_action_processing_ms": 0.11028013936928165, "mean_env_wait_ms": 1.1510611885379993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016176700592041016, "StateBufferConnector_ms": 0.003159046173095703, "ViewRequirementAgentConnector_ms": 0.14622211456298828}}, "episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2672162218315314, "mean_inference_ms": 0.7216551083868221, "mean_action_processing_ms": 0.11028013936928165, "mean_env_wait_ms": 1.1510611885379993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016176700592041016, "StateBufferConnector_ms": 0.003159046173095703, "ViewRequirementAgentConnector_ms": 0.14622211456298828}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.901146065443754}, "default_policy": {"total_loss": 9.901146065443754, "policy_loss": -0.0008270091784652323, "vf_loss": 9.902780823409557, "vf_loss_unclipped": 602.2994286417961, "vf_explained_var": -0.03063127864152193, "entropy": 5.394733231514692, "mean_kl_loss": 0.007091757911098284, "gradients_default_optimizer_global_norm": 1.4896563921356574, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.00019531250291038305}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12800, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 322.0166520239819, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12800, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 1489.07, "sample_time_ms": 1143.214, "synch_weights_time_ms": 0.66}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 25, "trial_id": "84157_00000", "date": "2023-07-25_14-23-11", "timestamp": 1690291391, "time_this_iter_s": 15.678305864334106, "time_total_s": 376.72295117378235, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 376.72295117378235, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 11.359090909090911, "ram_util_percent": 75.23181818181817}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2672250563928364, "mean_inference_ms": 0.7215651067962804, "mean_action_processing_ms": 0.1103068045159618, "mean_env_wait_ms": 1.1512776035402714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01354217529296875, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.14263391494750977}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2672250563928364, "mean_inference_ms": 0.7215651067962804, "mean_action_processing_ms": 0.1103068045159618, "mean_env_wait_ms": 1.1512776035402714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01354217529296875, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.14263391494750977}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.899600930511951}, "default_policy": {"total_loss": 9.899600930511951, "policy_loss": -0.0014312596467789263, "vf_loss": 9.901852153241634, "vf_loss_unclipped": 575.852619022131, "vf_explained_var": -0.14587030513212085, "entropy": 5.471752114593983, "mean_kl_loss": 0.003723814755858257, "gradients_default_optimizer_global_norm": 1.4811277367407456, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 9.765625145519152e-05}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 0, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 317.4372996323464, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 13312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 1504.02, "sample_time_ms": 1156.776, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 26, "trial_id": "84157_00000", "date": "2023-07-25_14-23-26", "timestamp": 1690291406, "time_this_iter_s": 15.200191736221313, "time_total_s": 391.92314291000366, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 391.92314291000366, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 11.304545454545455, "ram_util_percent": 75.46363636363638}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26727878010058626, "mean_inference_ms": 0.7219056010370636, "mean_action_processing_ms": 0.11033742105712642, "mean_env_wait_ms": 1.152675336274433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014185905456542969, "StateBufferConnector_ms": 0.0036835670471191406, "ViewRequirementAgentConnector_ms": 0.1438140869140625}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26727878010058626, "mean_inference_ms": 0.7219056010370636, "mean_action_processing_ms": 0.11033742105712642, "mean_env_wait_ms": 1.152675336274433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014185905456542969, "StateBufferConnector_ms": 0.0036835670471191406, "ViewRequirementAgentConnector_ms": 0.1438140869140625}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.895238097757101}, "default_policy": {"total_loss": 9.895238097757101, "policy_loss": -0.004270626668585464, "vf_loss": 9.900326654314995, "vf_loss_unclipped": 549.7969175875187, "vf_explained_var": -0.02027286682277918, "entropy": 5.453451916575432, "mean_kl_loss": 0.0032693194289095118, "gradients_default_optimizer_global_norm": 1.5491570038720965, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 4.882812572759576e-05}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 0, "num_env_steps_sampled": 13824, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 320.5815756820117, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 13824, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 13824, "timers": {"training_iteration_time_ms": 1514.989, "sample_time_ms": 1167.198, "synch_weights_time_ms": 0.65}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 27, "trial_id": "84157_00000", "date": "2023-07-25_14-23-41", "timestamp": 1690291421, "time_this_iter_s": 15.455994129180908, "time_total_s": 407.37913703918457, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 407.37913703918457, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 11.504545454545454, "ram_util_percent": 76.12272727272727}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26748409028622394, "mean_inference_ms": 0.7230547784175911, "mean_action_processing_ms": 0.11043754758061744, "mean_env_wait_ms": 1.1587024431139346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014674663543701172, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.15616416931152344}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26748409028622394, "mean_inference_ms": 0.7230547784175911, "mean_action_processing_ms": 0.11043754758061744, "mean_env_wait_ms": 1.1587024431139346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014674663543701172, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.15616416931152344}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.896304249763489}, "default_policy": {"total_loss": 9.896304249763489, "policy_loss": 0.0006159431068226695, "vf_loss": 9.896515648812056, "vf_loss_unclipped": 523.1046134531498, "vf_explained_var": -0.08348016301169991, "entropy": 5.5164330042898655, "mean_kl_loss": 0.004770227995322784, "gradients_default_optimizer_global_norm": 1.4153636986156926, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 2.441406286379788e-05}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 0, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 313.16669986720757, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 14336, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 1531.648, "sample_time_ms": 1180.39, "synch_weights_time_ms": 0.649}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 28, "trial_id": "84157_00000", "date": "2023-07-25_14-23-58", "timestamp": 1690291438, "time_this_iter_s": 16.467085361480713, "time_total_s": 423.8462224006653, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 423.8462224006653, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 11.52608695652174, "ram_util_percent": 75.99565217391304}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2676528464550198, "mean_inference_ms": 0.7236861163726173, "mean_action_processing_ms": 0.11053631686216667, "mean_env_wait_ms": 1.160780407004104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014412403106689453, "StateBufferConnector_ms": 0.0029921531677246094, "ViewRequirementAgentConnector_ms": 0.14429092407226562}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2676528464550198, "mean_inference_ms": 0.7236861163726173, "mean_action_processing_ms": 0.11053631686216667, "mean_env_wait_ms": 1.160780407004104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014412403106689453, "StateBufferConnector_ms": 0.0029921531677246094, "ViewRequirementAgentConnector_ms": 0.14429092407226562}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.888740085065365}, "default_policy": {"total_loss": 9.888740085065365, "policy_loss": -0.0035513939219526947, "vf_loss": 9.893116809427738, "vf_loss_unclipped": 496.7491372525692, "vf_explained_var": -0.11006422247737646, "entropy": 5.501991484314203, "mean_kl_loss": 0.00450730019679213, "gradients_default_optimizer_global_norm": 1.4881531419232488, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 1.220703143189894e-05}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2678931173626756, "mean_inference_ms": 0.7131128496018648, "mean_action_processing_ms": 0.10999859124841119, "mean_env_wait_ms": 1.0964261332959042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020742416381835938, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15796422958374023}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 0, "num_env_steps_sampled": 14848, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 322.6818193292615, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 14848, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 14848, "timers": {"training_iteration_time_ms": 1545.943, "sample_time_ms": 1192.337, "synch_weights_time_ms": 0.652}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 29, "trial_id": "84157_00000", "date": "2023-07-25_14-24-14", "timestamp": 1690291454, "time_this_iter_s": 15.724878072738647, "time_total_s": 439.57110047340393, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 439.57110047340393, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 11.273913043478261, "ram_util_percent": 76.56956521739129}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2681486292721585, "mean_inference_ms": 0.7254922682243949, "mean_action_processing_ms": 0.11076365500497654, "mean_env_wait_ms": 1.1683690938748732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01474618911743164, "StateBufferConnector_ms": 0.0030040740966796875, "ViewRequirementAgentConnector_ms": 0.17620325088500977}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2681486292721585, "mean_inference_ms": 0.7254922682243949, "mean_action_processing_ms": 0.11076365500497654, "mean_env_wait_ms": 1.1683690938748732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01474618911743164, "StateBufferConnector_ms": 0.0030040740966796875, "ViewRequirementAgentConnector_ms": 0.17620325088500977}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.730874009430408}, "default_policy": {"total_loss": 9.730874009430408, "policy_loss": -0.004031450836919248, "vf_loss": 9.735754169523716, "vf_loss_unclipped": 374.41998244822025, "vf_explained_var": 0.004405347164720297, "entropy": 5.657551538199186, "mean_kl_loss": 0.005303982368559446, "gradients_default_optimizer_global_norm": 2.2787853402551264, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 1.220703143189894e-05}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 0, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 303.2340240343917, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 15360, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 1576.481, "sample_time_ms": 1219.059, "synch_weights_time_ms": 0.667}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 30, "trial_id": "84157_00000", "date": "2023-07-25_14-24-31", "timestamp": 1690291471, "time_this_iter_s": 17.151302576065063, "time_total_s": 456.722403049469, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 456.722403049469, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 11.387500000000001, "ram_util_percent": 76.77083333333333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26865131392878794, "mean_inference_ms": 0.7268870584614856, "mean_action_processing_ms": 0.1109285992085711, "mean_env_wait_ms": 1.1763720319323399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016605854034423828, "StateBufferConnector_ms": 0.0034570693969726562, "ViewRequirementAgentConnector_ms": 0.16453266143798828}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26865131392878794, "mean_inference_ms": 0.7268870584614856, "mean_action_processing_ms": 0.1109285992085711, "mean_env_wait_ms": 1.1763720319323399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016605854034423828, "StateBufferConnector_ms": 0.0034570693969726562, "ViewRequirementAgentConnector_ms": 0.16453266143798828}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.87612547725439}, "default_policy": {"total_loss": 9.87612547725439, "policy_loss": -0.005152481433469802, "vf_loss": 9.882111512124538, "vf_loss_unclipped": 423.34818014502525, "vf_explained_var": -0.15035392483696342, "entropy": 5.557513054460287, "mean_kl_loss": 0.00414454475594539, "gradients_default_optimizer_global_norm": 1.498203431488946, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 6.10351571594947e-06}}, "num_env_steps_sampled": 15872, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 0, "num_env_steps_sampled": 15872, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 279.3145118358068, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 15872, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 15872, "timers": {"training_iteration_time_ms": 1614.947, "sample_time_ms": 1251.558, "synch_weights_time_ms": 0.666}, "counters": {"num_env_steps_sampled": 15872, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 31, "trial_id": "84157_00000", "date": "2023-07-25_14-24-48", "timestamp": 1690291488, "time_this_iter_s": 17.40617823600769, "time_total_s": 474.1285812854767, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 474.1285812854767, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 11.48, "ram_util_percent": 83.384}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2687419203602876, "mean_inference_ms": 0.7270940583776466, "mean_action_processing_ms": 0.11095571967212006, "mean_env_wait_ms": 1.1821032661938944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015532970428466797, "StateBufferConnector_ms": 0.0030279159545898438, "ViewRequirementAgentConnector_ms": 0.1620173454284668}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2687419203602876, "mean_inference_ms": 0.7270940583776466, "mean_action_processing_ms": 0.11095571967212006, "mean_env_wait_ms": 1.1821032661938944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015532970428466797, "StateBufferConnector_ms": 0.0030279159545898438, "ViewRequirementAgentConnector_ms": 0.1620173454284668}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.87909958139062}, "default_policy": {"total_loss": 9.87909958139062, "policy_loss": 0.00010030940757133067, "vf_loss": 9.879795469343662, "vf_loss_unclipped": 400.73470786213875, "vf_explained_var": -0.031695852521806955, "entropy": 5.3083297945559025, "mean_kl_loss": 0.002261838612412248, "gradients_default_optimizer_global_norm": 1.621502032619901, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 3.051757857974735e-06}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 314.0649287933702, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16384, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 1625.451, "sample_time_ms": 1261.628, "synch_weights_time_ms": 0.664}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 32, "trial_id": "84157_00000", "date": "2023-07-25_14-25-05", "timestamp": 1690291505, "time_this_iter_s": 16.551964044570923, "time_total_s": 490.6805453300476, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 490.6805453300476, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 11.213043478260868, "ram_util_percent": 90.58695652173913}}
{"evaluation": {"sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, 0.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26900070692464434, "mean_inference_ms": 0.7275288918074442, "mean_action_processing_ms": 0.11103614445967525, "mean_env_wait_ms": 1.1865582312165663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01373291015625, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1430511474609375}}, "episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, 0.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26900070692464434, "mean_inference_ms": 0.7275288918074442, "mean_action_processing_ms": 0.11103614445967525, "mean_env_wait_ms": 1.1865582312165663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01373291015625, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1430511474609375}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.871572162956}, "default_policy": {"total_loss": 9.871572162956, "policy_loss": -0.003480211889836937, "vf_loss": 9.875852141529322, "vf_loss_unclipped": 378.1808102428913, "vf_explained_var": -0.04781044088304043, "entropy": 5.331940766423941, "mean_kl_loss": 0.0033936770289528795, "gradients_default_optimizer_global_norm": 1.5309632781427354, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 1.5258789289873675e-06}}, "num_env_steps_sampled": 16896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 320.03654897378885, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16896, "timers": {"training_iteration_time_ms": 1634.406, "sample_time_ms": 1271.41, "synch_weights_time_ms": 0.662}, "counters": {"num_env_steps_sampled": 16896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 33, "trial_id": "84157_00000", "date": "2023-07-25_14-25-21", "timestamp": 1690291521, "time_this_iter_s": 16.430580615997314, "time_total_s": 507.1111259460449, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 507.1111259460449, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 11.233333333333334, "ram_util_percent": 90.7375}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2691309571066909, "mean_inference_ms": 0.7280043264563663, "mean_action_processing_ms": 0.11111265416209627, "mean_env_wait_ms": 1.190792058561486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015079975128173828, "StateBufferConnector_ms": 0.0030994415283203125, "ViewRequirementAgentConnector_ms": 0.16826391220092773}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2691309571066909, "mean_inference_ms": 0.7280043264563663, "mean_action_processing_ms": 0.11111265416209627, "mean_env_wait_ms": 1.190792058561486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015079975128173828, "StateBufferConnector_ms": 0.0030994415283203125, "ViewRequirementAgentConnector_ms": 0.16826391220092773}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.867893248796463}, "default_policy": {"total_loss": 9.867893248796463, "policy_loss": -0.0032772823178675026, "vf_loss": 9.871975798159838, "vf_loss_unclipped": 356.51924853026867, "vf_explained_var": 0.005611584056168795, "entropy": 5.368687409907579, "mean_kl_loss": 0.0028527318612532326, "gradients_default_optimizer_global_norm": 1.6872988033574075, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 7.629394644936838e-07}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 0, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 295.9737407616899, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 17408, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 1650.282, "sample_time_ms": 1282.498, "synch_weights_time_ms": 0.669}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 34, "trial_id": "84157_00000", "date": "2023-07-25_14-25-38", "timestamp": 1690291538, "time_this_iter_s": 16.560490369796753, "time_total_s": 523.6716163158417, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 523.6716163158417, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 11.330434782608696, "ram_util_percent": 90.73913043478261}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26982209714719074, "mean_inference_ms": 0.7299577398928366, "mean_action_processing_ms": 0.11135381397548473, "mean_env_wait_ms": 1.1960719009931216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013649463653564453, "StateBufferConnector_ms": 0.0028371810913085938, "ViewRequirementAgentConnector_ms": 0.14253854751586914}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26982209714719074, "mean_inference_ms": 0.7299577398928366, "mean_action_processing_ms": 0.11135381397548473, "mean_env_wait_ms": 1.1960719009931216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013649463653564453, "StateBufferConnector_ms": 0.0028371810913085938, "ViewRequirementAgentConnector_ms": 0.14253854751586914}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.86621842160821}, "default_policy": {"total_loss": 9.86621842160821, "policy_loss": -0.0009778462117537856, "vf_loss": 9.867999747395515, "vf_loss_unclipped": 335.83421501517296, "vf_explained_var": 0.026889157947152853, "entropy": 5.356351055204868, "mean_kl_loss": 0.005605584520594675, "gradients_default_optimizer_global_norm": 1.6943799573346041, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 7.629394644936838e-07}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682736673326724, "mean_inference_ms": 0.7141197625400816, "mean_action_processing_ms": 0.11009129946839162, "mean_env_wait_ms": 1.1060381953141072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02064228057861328, "StateBufferConnector_ms": 0.0030803680419921875, "ViewRequirementAgentConnector_ms": 0.15566349029541016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 0, "num_env_steps_sampled": 17920, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 326.6617738774462, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 17920, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 17920, "timers": {"training_iteration_time_ms": 1648.021, "sample_time_ms": 1278.461, "synch_weights_time_ms": 0.675}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 5, "training_iteration": 35, "trial_id": "84157_00000", "date": "2023-07-25_14-25-55", "timestamp": 1690291555, "time_this_iter_s": 17.142563819885254, "time_total_s": 540.8141801357269, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 540.8141801357269, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 11.336000000000002, "ram_util_percent": 90.852}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27019601808185995, "mean_inference_ms": 0.7307035395472373, "mean_action_processing_ms": 0.11145168271082574, "mean_env_wait_ms": 1.201206784307493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014185905456542969, "StateBufferConnector_ms": 0.002849102020263672, "ViewRequirementAgentConnector_ms": 0.14652013778686523}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27019601808185995, "mean_inference_ms": 0.7307035395472373, "mean_action_processing_ms": 0.11145168271082574, "mean_env_wait_ms": 1.201206784307493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014185905456542969, "StateBufferConnector_ms": 0.002849102020263672, "ViewRequirementAgentConnector_ms": 0.14652013778686523}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.658462829887867}, "default_policy": {"total_loss": 9.658462829887867, "policy_loss": -0.010136269323993474, "vf_loss": 9.669434364885092, "vf_loss_unclipped": 256.66012755036354, "vf_explained_var": -0.09629778657108545, "entropy": 5.568527992814779, "mean_kl_loss": 0.005865735779707393, "gradients_default_optimizer_global_norm": 2.5319070372497663, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 7.629394644936838e-07}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 0, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 316.9095436615395, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 18432, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 1648.289, "sample_time_ms": 1273.874, "synch_weights_time_ms": 0.674}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 36, "trial_id": "84157_00000", "date": "2023-07-25_14-26-12", "timestamp": 1690291572, "time_this_iter_s": 16.89471673965454, "time_total_s": 557.7088968753815, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 557.7088968753815, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 12.145833333333334, "ram_util_percent": 91.7375}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27100844674087626, "mean_inference_ms": 0.7331786465278297, "mean_action_processing_ms": 0.11175751069110351, "mean_env_wait_ms": 1.206801962536414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014507770538330078, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1475214958190918}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27100844674087626, "mean_inference_ms": 0.7331786465278297, "mean_action_processing_ms": 0.11175751069110351, "mean_env_wait_ms": 1.206801962536414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014507770538330078, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1475214958190918}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.84818003885448}, "default_policy": {"total_loss": 9.84818003885448, "policy_loss": -0.0019185069540981203, "vf_loss": 9.850909933447838, "vf_loss_unclipped": 276.20943109691143, "vf_explained_var": -0.016412962693721056, "entropy": 5.409391179680824, "mean_kl_loss": 0.0028150553180239513, "gradients_default_optimizer_global_norm": 1.7078759988653474, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 3.814697322468419e-07}}, "num_env_steps_sampled": 18944, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 0, "num_env_steps_sampled": 18944, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 314.1746511281553, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 18944, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 18944, "timers": {"training_iteration_time_ms": 1651.546, "sample_time_ms": 1274.41, "synch_weights_time_ms": 0.677}, "counters": {"num_env_steps_sampled": 18944, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 37, "trial_id": "84157_00000", "date": "2023-07-25_14-26-30", "timestamp": 1690291590, "time_this_iter_s": 17.61985683441162, "time_total_s": 575.3287537097931, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 575.3287537097931, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 11.388000000000002, "ram_util_percent": 93.132}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27297048200516894, "mean_inference_ms": 0.7389792240465782, "mean_action_processing_ms": 0.11259401759187553, "mean_env_wait_ms": 1.218532290484968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015616416931152344, "StateBufferConnector_ms": 0.0032782554626464844, "ViewRequirementAgentConnector_ms": 0.16176700592041016}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27297048200516894, "mean_inference_ms": 0.7389792240465782, "mean_action_processing_ms": 0.11259401759187553, "mean_env_wait_ms": 1.218532290484968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015616416931152344, "StateBufferConnector_ms": 0.0032782554626464844, "ViewRequirementAgentConnector_ms": 0.16176700592041016}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.847332630306482}, "default_policy": {"total_loss": 9.847332630306482, "policy_loss": 0.0003949172096326947, "vf_loss": 9.847756769508123, "vf_loss_unclipped": 258.90588085353374, "vf_explained_var": -0.029002351686358452, "entropy": 5.460212469100952, "mean_kl_loss": 0.003243689123934246, "gradients_default_optimizer_global_norm": 1.826327376475092, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 1.9073486612342094e-07}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 0, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 311.2314537612336, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 19456, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 1652.563, "sample_time_ms": 1275.01, "synch_weights_time_ms": 0.679}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 38, "trial_id": "84157_00000", "date": "2023-07-25_14-26-50", "timestamp": 1690291610, "time_this_iter_s": 20.297369480133057, "time_total_s": 595.6261231899261, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 595.6261231899261, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 11.49655172413793, "ram_util_percent": 93.36206896551725}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2732598668133577, "mean_inference_ms": 0.7398022515595032, "mean_action_processing_ms": 0.11274519854362478, "mean_env_wait_ms": 1.223899049224326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016319751739501953, "StateBufferConnector_ms": 0.0029802322387695312, "ViewRequirementAgentConnector_ms": 0.14652013778686523}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2732598668133577, "mean_inference_ms": 0.7398022515595032, "mean_action_processing_ms": 0.11274519854362478, "mean_env_wait_ms": 1.223899049224326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016319751739501953, "StateBufferConnector_ms": 0.0029802322387695312, "ViewRequirementAgentConnector_ms": 0.14652013778686523}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.8401661477983}, "default_policy": {"total_loss": 9.8401661477983, "policy_loss": -0.0009290310263168067, "vf_loss": 9.841918617486954, "vf_loss_unclipped": 241.71663790941238, "vf_explained_var": -0.053681168239563704, "entropy": 5.490439604967833, "mean_kl_loss": 0.0023356870814268405, "gradients_default_optimizer_global_norm": 1.73704611643916, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 9.536743306171047e-08}}, "num_env_steps_sampled": 19968, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 0, "num_env_steps_sampled": 19968, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 322.65413602180274, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 19968, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 19968, "timers": {"training_iteration_time_ms": 1652.577, "sample_time_ms": 1274.837, "synch_weights_time_ms": 0.673}, "counters": {"num_env_steps_sampled": 19968, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 39, "trial_id": "84157_00000", "date": "2023-07-25_14-27-07", "timestamp": 1690291627, "time_this_iter_s": 17.261110305786133, "time_total_s": 612.8872334957123, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 612.8872334957123, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 11.25, "ram_util_percent": 93.42083333333333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2737025270942805, "mean_inference_ms": 0.7412998922297327, "mean_action_processing_ms": 0.11294669038777026, "mean_env_wait_ms": 1.2278215528956546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01519918441772461, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15234947204589844}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2737025270942805, "mean_inference_ms": 0.7412998922297327, "mean_action_processing_ms": 0.11294669038777026, "mean_env_wait_ms": 1.2278215528956546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01519918441772461, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.15234947204589844}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.83373005501926}, "default_policy": {"total_loss": 9.83373005501926, "policy_loss": -6.052281241863966e-05, "vf_loss": 9.834620364010334, "vf_loss_unclipped": 224.65676341950893, "vf_explained_var": -0.05840154970064759, "entropy": 5.531606577336788, "mean_kl_loss": 0.0027236050133296885, "gradients_default_optimizer_global_norm": 1.7574402915779501, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 4.7683716530855236e-08}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 308.6286690982527, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20480, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 1649.625, "sample_time_ms": 1269.242, "synch_weights_time_ms": 0.661}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 40, "trial_id": "84157_00000", "date": "2023-07-25_14-27-25", "timestamp": 1690291645, "time_this_iter_s": 17.279672861099243, "time_total_s": 630.1669063568115, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 630.1669063568115, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 11.351999999999999, "ram_util_percent": 93.35600000000002}}
{"evaluation": {"sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, 0.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2740717481401592, "mean_inference_ms": 0.7425009416616355, "mean_action_processing_ms": 0.11308356581000545, "mean_env_wait_ms": 1.232472179999202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014030933380126953, "StateBufferConnector_ms": 0.002872943878173828, "ViewRequirementAgentConnector_ms": 0.15079975128173828}}, "episode_reward_max": 0.0, "episode_reward_min": -3000.0, "episode_reward_mean": -1500.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, 0.0], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2740717481401592, "mean_inference_ms": 0.7425009416616355, "mean_action_processing_ms": 0.11308356581000545, "mean_env_wait_ms": 1.232472179999202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014030933380126953, "StateBufferConnector_ms": 0.002872943878173828, "ViewRequirementAgentConnector_ms": 0.15079975128173828}, "num_agent_steps_sampled_this_iter": 6000, "num_env_steps_sampled_this_iter": 6000, "timesteps_this_iter": 6000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 9.824963599443436}, "default_policy": {"total_loss": 9.824963599443436, "policy_loss": -0.0015935106202960014, "vf_loss": 9.827400267124176, "vf_loss_unclipped": 208.35635921359062, "vf_explained_var": -0.02274554129689932, "entropy": 5.621183060109615, "mean_kl_loss": 0.0029554423567788035, "gradients_default_optimizer_global_norm": 1.9103609228041023, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 2.3841858265427618e-08}}, "num_env_steps_sampled": 20992, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}}, "episode_reward_max": -3000.0, "episode_reward_min": -3000.0, "episode_reward_mean": -3000.0, "episode_len_mean": 3000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3000.0, -3000.0, -3000.0, -3000.0, -3000.0, -3000.0], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2690350436335711, "mean_inference_ms": 0.7165502086341474, "mean_action_processing_ms": 0.11035887136679107, "mean_env_wait_ms": 1.1166916978318897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021258989969889324, "StateBufferConnector_ms": 0.0031034151713053384, "ViewRequirementAgentConnector_ms": 0.15633503595987955}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20992, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 298.8566330325725, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20992, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20992, "timers": {"training_iteration_time_ms": 1637.64, "sample_time_ms": 1258.095, "synch_weights_time_ms": 0.662}, "counters": {"num_env_steps_sampled": 20992, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 41, "trial_id": "84157_00000", "date": "2023-07-25_14-27-42", "timestamp": 1690291662, "time_this_iter_s": 17.47890830039978, "time_total_s": 647.6458146572113, "pid": 53359, "hostname": "Persephone", "node_ip": "172.21.2.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcb7033b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 647.6458146572113, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 11.368, "ram_util_percent": 93.63600000000001}}
