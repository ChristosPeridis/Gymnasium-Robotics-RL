{"evaluation": {"sampler_results": {"episode_reward_max": -16.647935114829497, "episode_reward_min": -19.78868767143619, "episode_reward_mean": -18.218311393132844, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.78868767143619, -16.647935114829497], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2616377019170505, "mean_inference_ms": 0.5902354396990875, "mean_action_processing_ms": 0.08805592854817708, "mean_env_wait_ms": 0.9638444701237464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015854835510253906, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13464689254760742}}, "episode_reward_max": -16.647935114829497, "episode_reward_min": -19.78868767143619, "episode_reward_mean": -18.218311393132844, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.78868767143619, -16.647935114829497], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2616377019170505, "mean_inference_ms": 0.5902354396990875, "mean_action_processing_ms": 0.08805592854817708, "mean_env_wait_ms": 0.9638444701237464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015854835510253906, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13464689254760742}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 6.3874848460254725}, "default_policy": {"total_loss": 6.3874848460254725, "policy_loss": 0.008543982985429466, "vf_loss": 6.377339288592339, "vf_loss_unclipped": 16.639071779325604, "vf_explained_var": -0.004498565569519997, "entropy": 5.570431251078844, "mean_kl_loss": 0.012185660824798219, "gradients_default_optimizer_global_norm": 9.971804350148886, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -15.745313472212617, "episode_reward_min": -27.30752167268913, "episode_reward_mean": -20.397698172822018, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913], "episode_lengths": [100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28875955315523366, "mean_inference_ms": 0.634235467097556, "mean_action_processing_ms": 0.0933237778123959, "mean_env_wait_ms": 1.0267750237339226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016176700592041016, "StateBufferConnector_ms": 0.002282857894897461, "ViewRequirementAgentConnector_ms": 0.1390516757965088}}, "episode_reward_max": -15.745313472212617, "episode_reward_min": -27.30752167268913, "episode_reward_mean": -20.397698172822018, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913], "episode_lengths": [100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28875955315523366, "mean_inference_ms": 0.634235467097556, "mean_action_processing_ms": 0.0933237778123959, "mean_env_wait_ms": 1.0267750237339226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016176700592041016, "StateBufferConnector_ms": 0.002282857894897461, "ViewRequirementAgentConnector_ms": 0.1390516757965088}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 0, "num_env_steps_sampled": 512, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 861.0016594705492, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 512, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 512, "timers": {"training_iteration_time_ms": 594.631, "sample_time_ms": 280.201, "synch_weights_time_ms": 2.913}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 1, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-36", "timestamp": 1690476516, "time_this_iter_s": 0.9823455810546875, "time_total_s": 0.9823455810546875, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 0.9823455810546875, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 8.649999999999999, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -14.968124121102475, "episode_reward_min": -17.117791775309936, "episode_reward_mean": -16.042957948206205, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.968124121102475, -17.117791775309936], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26082397993663303, "mean_inference_ms": 0.5884182423427515, "mean_action_processing_ms": 0.08809001665757482, "mean_env_wait_ms": 0.9663271487799666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015866756439208984, "StateBufferConnector_ms": 0.0022292137145996094, "ViewRequirementAgentConnector_ms": 0.13456344604492188}}, "episode_reward_max": -14.968124121102475, "episode_reward_min": -17.117791775309936, "episode_reward_mean": -16.042957948206205, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.968124121102475, -17.117791775309936], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26082397993663303, "mean_inference_ms": 0.5884182423427515, "mean_action_processing_ms": 0.08809001665757482, "mean_env_wait_ms": 0.9663271487799666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015866756439208984, "StateBufferConnector_ms": 0.0022292137145996094, "ViewRequirementAgentConnector_ms": 0.13456344604492188}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 6.368713882999145}, "default_policy": {"total_loss": 6.368713882999145, "policy_loss": 0.0003327206359244883, "vf_loss": 6.365565512969624, "vf_loss_unclipped": 40.08708656829549, "vf_explained_var": -0.021803374402225018, "entropy": 5.693575505167246, "mean_kl_loss": 0.018348314275328903, "gradients_default_optimizer_global_norm": 12.177405904978514, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -15.745313472212617, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -27.931491748645115, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28673584574909194, "mean_inference_ms": 0.6380370264588677, "mean_action_processing_ms": 0.09368195223225059, "mean_env_wait_ms": 1.0339101202343468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016498565673828125, "StateBufferConnector_ms": 0.0023037195205688477, "ViewRequirementAgentConnector_ms": 0.1388847827911377}}, "episode_reward_max": -15.745313472212617, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -27.931491748645115, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28673584574909194, "mean_inference_ms": 0.6380370264588677, "mean_action_processing_ms": 0.09368195223225059, "mean_env_wait_ms": 1.0339101202343468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016498565673828125, "StateBufferConnector_ms": 0.0023037195205688477, "ViewRequirementAgentConnector_ms": 0.1388847827911377}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 869.1018085144701, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1024, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 591.863, "sample_time_ms": 281.587, "synch_weights_time_ms": 2.636}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 2, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-37", "timestamp": 1690476517, "time_this_iter_s": 0.9740345478057861, "time_total_s": 1.9563801288604736, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1.9563801288604736, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 7.2, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -16.911418131238605, "episode_reward_min": -33.89556090677542, "episode_reward_mean": -25.403489519007014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.911418131238605, -33.89556090677542], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2608890343029765, "mean_inference_ms": 0.5878668259860276, "mean_action_processing_ms": 0.08833031487742597, "mean_env_wait_ms": 0.9788010957435443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017011165618896484, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.13622045516967773}}, "episode_reward_max": -16.911418131238605, "episode_reward_min": -33.89556090677542, "episode_reward_mean": -25.403489519007014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.911418131238605, -33.89556090677542], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2608890343029765, "mean_inference_ms": 0.5878668259860276, "mean_action_processing_ms": 0.08833031487742597, "mean_env_wait_ms": 0.9788010957435443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017011165618896484, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.13622045516967773}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.945586787143839}, "default_policy": {"total_loss": 5.945586787143839, "policy_loss": -0.006771465472411364, "vf_loss": 5.952095646091038, "vf_loss_unclipped": 29.681145220674807, "vf_explained_var": 0.09217751119285822, "entropy": 5.61841244623065, "mean_kl_loss": 0.005526859797214456, "gradients_default_optimizer_global_norm": 16.103149011265486, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8.265324291859377, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -25.990407418613575, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.284649773525877, "mean_inference_ms": 0.6369327289640938, "mean_action_processing_ms": 0.09353487047202946, "mean_env_wait_ms": 1.0319000573928923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016480684280395508, "StateBufferConnector_ms": 0.0023027261098225913, "ViewRequirementAgentConnector_ms": 0.1393397649129232}}, "episode_reward_max": -8.265324291859377, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -25.990407418613575, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.284649773525877, "mean_inference_ms": 0.6369327289640938, "mean_action_processing_ms": 0.09353487047202946, "mean_env_wait_ms": 1.0319000573928923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016480684280395508, "StateBufferConnector_ms": 0.0023027261098225913, "ViewRequirementAgentConnector_ms": 0.1393397649129232}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1536, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 899.5619018496138, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1536, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1536, "timers": {"training_iteration_time_ms": 584.291, "sample_time_ms": 275.213, "synch_weights_time_ms": 2.501}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 3, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-38", "timestamp": 1690476518, "time_this_iter_s": 0.9615602493286133, "time_total_s": 2.917940378189087, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 2.917940378189087, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -24.883656579374442, "episode_reward_min": -25.80073354342714, "episode_reward_mean": -25.34219506140079, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.80073354342714, -24.883656579374442], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26048971026131273, "mean_inference_ms": 0.5876461367184451, "mean_action_processing_ms": 0.08840239449833216, "mean_env_wait_ms": 0.9833810927716087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016307830810546875, "StateBufferConnector_ms": 0.0022411346435546875, "ViewRequirementAgentConnector_ms": 0.1347184181213379}}, "episode_reward_max": -24.883656579374442, "episode_reward_min": -25.80073354342714, "episode_reward_mean": -25.34219506140079, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.80073354342714, -24.883656579374442], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26048971026131273, "mean_inference_ms": 0.5876461367184451, "mean_action_processing_ms": 0.08840239449833216, "mean_env_wait_ms": 0.9833810927716087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016307830810546875, "StateBufferConnector_ms": 0.0022411346435546875, "ViewRequirementAgentConnector_ms": 0.1347184181213379}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 3.587196186563233}, "default_policy": {"total_loss": 3.587196186563233, "policy_loss": 0.016647255746647716, "vf_loss": 3.56677076802589, "vf_loss_unclipped": 14.265473073581234, "vf_explained_var": 0.06602569669485092, "entropy": 5.640044718980789, "mean_kl_loss": 0.02312094663901121, "gradients_default_optimizer_global_norm": 21.324772909283638, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8.265324291859377, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -26.260374175236553, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2839120903175262, "mean_inference_ms": 0.6348534010964941, "mean_action_processing_ms": 0.09336181138816865, "mean_env_wait_ms": 1.0282069671437024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01678466796875, "StateBufferConnector_ms": 0.0023567676544189453, "ViewRequirementAgentConnector_ms": 0.14176011085510254}}, "episode_reward_max": -8.265324291859377, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -26.260374175236553, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2839120903175262, "mean_inference_ms": 0.6348534010964941, "mean_action_processing_ms": 0.09336181138816865, "mean_env_wait_ms": 1.0282069671437024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01678466796875, "StateBufferConnector_ms": 0.0023567676544189453, "ViewRequirementAgentConnector_ms": 0.14176011085510254}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 0, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 892.1025981881144, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 2048, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 581.695, "sample_time_ms": 272.658, "synch_weights_time_ms": 2.446}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 4, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-39", "timestamp": 1690476519, "time_this_iter_s": 0.9647271633148193, "time_total_s": 3.8826675415039062, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 3.8826675415039062, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -9.971851907491144, "episode_reward_min": -20.418616289628755, "episode_reward_mean": -15.19523409855995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.418616289628755, -9.971851907491144], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26055863806298685, "mean_inference_ms": 0.5882812903953957, "mean_action_processing_ms": 0.08857547939121425, "mean_env_wait_ms": 0.9869786051960735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01614093780517578, "StateBufferConnector_ms": 0.0021219253540039062, "ViewRequirementAgentConnector_ms": 0.13567209243774414}}, "episode_reward_max": -9.971851907491144, "episode_reward_min": -20.418616289628755, "episode_reward_mean": -15.19523409855995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.418616289628755, -9.971851907491144], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26055863806298685, "mean_inference_ms": 0.5882812903953957, "mean_action_processing_ms": 0.08857547939121425, "mean_env_wait_ms": 0.9869786051960735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01614093780517578, "StateBufferConnector_ms": 0.0021219253540039062, "ViewRequirementAgentConnector_ms": 0.13567209243774414}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.73161684841034}, "default_policy": {"total_loss": 5.73161684841034, "policy_loss": 0.003045602104975842, "vf_loss": 5.727549592847936, "vf_loss_unclipped": 15.54329655773472, "vf_explained_var": -0.043349489569664, "entropy": 5.8734870702028275, "mean_kl_loss": 0.006342121441434756, "gradients_default_optimizer_global_norm": 22.72357254824601, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8.265324291859377, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -26.570483036127744, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2836322133202171, "mean_inference_ms": 0.6348813039850197, "mean_action_processing_ms": 0.09343244788571164, "mean_env_wait_ms": 1.0286607327808042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016715129216512043, "StateBufferConnector_ms": 0.0023464361826578775, "ViewRequirementAgentConnector_ms": 0.1409977674484253}}, "episode_reward_max": -8.265324291859377, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -26.570483036127744, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2836322133202171, "mean_inference_ms": 0.6348813039850197, "mean_action_processing_ms": 0.09343244788571164, "mean_env_wait_ms": 1.0286607327808042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016715129216512043, "StateBufferConnector_ms": 0.0023464361826578775, "ViewRequirementAgentConnector_ms": 0.1409977674484253}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 0, "num_env_steps_sampled": 2560, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 883.2637813848942, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 2560, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2560, "timers": {"training_iteration_time_ms": 581.286, "sample_time_ms": 272.819, "synch_weights_time_ms": 2.478}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 5, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-40", "timestamp": 1690476520, "time_this_iter_s": 0.9724245071411133, "time_total_s": 4.8550920486450195, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 4.8550920486450195, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -6.631468550599653, "episode_reward_min": -32.026973211800346, "episode_reward_mean": -19.3292208812, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.026973211800346, -6.631468550599653], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2609220372945641, "mean_inference_ms": 0.5890769227954569, "mean_action_processing_ms": 0.08854560312085306, "mean_env_wait_ms": 0.9940246261228232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010418891906738281, "StateBufferConnector_ms": 0.0021219253540039062, "ViewRequirementAgentConnector_ms": 0.14241933822631836}}, "episode_reward_max": -6.631468550599653, "episode_reward_min": -32.026973211800346, "episode_reward_mean": -19.3292208812, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.026973211800346, -6.631468550599653], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2609220372945641, "mean_inference_ms": 0.5890769227954569, "mean_action_processing_ms": 0.08854560312085306, "mean_env_wait_ms": 0.9940246261228232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010418891906738281, "StateBufferConnector_ms": 0.0021219253540039062, "ViewRequirementAgentConnector_ms": 0.14241933822631836}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 2.995872978819534}, "default_policy": {"total_loss": 2.995872978819534, "policy_loss": 0.005598667077720165, "vf_loss": 2.9891548406940274, "vf_loss_unclipped": 6.995380575643139, "vf_explained_var": 0.07141035655513406, "entropy": 5.757287163287401, "mean_kl_loss": 0.00661019951758135, "gradients_default_optimizer_global_norm": 20.50323400180787, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -4.25627796234273, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -25.16987268564024, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2830804933307594, "mean_inference_ms": 0.6343405122150925, "mean_action_processing_ms": 0.09341021976545279, "mean_env_wait_ms": 1.0289612730499955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0166910035269601, "StateBufferConnector_ms": 0.002339056559971401, "ViewRequirementAgentConnector_ms": 0.14021907533918107}}, "episode_reward_max": -4.25627796234273, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -25.16987268564024, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2830804933307594, "mean_inference_ms": 0.6343405122150925, "mean_action_processing_ms": 0.09341021976545279, "mean_env_wait_ms": 1.0289612730499955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0166910035269601, "StateBufferConnector_ms": 0.002339056559971401, "ViewRequirementAgentConnector_ms": 0.14021907533918107}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 0, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 888.4024222647132, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 3072, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 580.454, "sample_time_ms": 272.217, "synch_weights_time_ms": 2.531}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 6, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-41", "timestamp": 1690476521, "time_this_iter_s": 0.9754974842071533, "time_total_s": 5.830589532852173, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 5.830589532852173, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -18.405969458383463, "episode_reward_min": -37.33268903803456, "episode_reward_mean": -27.869329248209013, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.33268903803456, -18.405969458383463], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26072186286920823, "mean_inference_ms": 0.5888292229575485, "mean_action_processing_ms": 0.08840189926289048, "mean_env_wait_ms": 0.9921507525665261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010180473327636719, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13556480407714844}}, "episode_reward_max": -18.405969458383463, "episode_reward_min": -37.33268903803456, "episode_reward_mean": -27.869329248209013, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.33268903803456, -18.405969458383463], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26072186286920823, "mean_inference_ms": 0.5888292229575485, "mean_action_processing_ms": 0.08840189926289048, "mean_env_wait_ms": 0.9921507525665261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010180473327636719, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13556480407714844}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.45950398684181}, "default_policy": {"total_loss": 4.45950398684181, "policy_loss": 0.004428143925906625, "vf_loss": 4.453356239259847, "vf_loss_unclipped": 14.811422161073097, "vf_explained_var": 0.14696101332083344, "entropy": 5.755931053310633, "mean_kl_loss": 0.008610023020310109, "gradients_default_optimizer_global_norm": 22.406996441539377, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -4.25627796234273, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -24.465944959456383, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2827405789387975, "mean_inference_ms": 0.6344154199660803, "mean_action_processing_ms": 0.09345816595475862, "mean_env_wait_ms": 1.030572943575817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01665651798248291, "StateBufferConnector_ms": 0.0023342669010162354, "ViewRequirementAgentConnector_ms": 0.13976171612739563}}, "episode_reward_max": -4.25627796234273, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -24.465944959456383, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2827405789387975, "mean_inference_ms": 0.6344154199660803, "mean_action_processing_ms": 0.09345816595475862, "mean_env_wait_ms": 1.030572943575817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01665651798248291, "StateBufferConnector_ms": 0.0023342669010162354, "ViewRequirementAgentConnector_ms": 0.13976171612739563}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 0, "num_env_steps_sampled": 3584, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 858.3877807818803, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 3584, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3584, "timers": {"training_iteration_time_ms": 582.738, "sample_time_ms": 274.552, "synch_weights_time_ms": 2.526}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 32, "training_iteration": 7, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-42", "timestamp": 1690476522, "time_this_iter_s": 0.9840536117553711, "time_total_s": 6.814643144607544, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 6.814643144607544, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -20.363524819085306, "episode_reward_min": -22.191611476665496, "episode_reward_mean": -21.2775681478754, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.191611476665496, -20.363524819085306], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606524146399894, "mean_inference_ms": 0.5888970176701542, "mean_action_processing_ms": 0.08833743422423058, "mean_env_wait_ms": 0.989201365226064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010716915130615234, "StateBufferConnector_ms": 0.0021696090698242188, "ViewRequirementAgentConnector_ms": 0.13511180877685547}}, "episode_reward_max": -20.363524819085306, "episode_reward_min": -22.191611476665496, "episode_reward_mean": -21.2775681478754, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.191611476665496, -20.363524819085306], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606524146399894, "mean_inference_ms": 0.5888970176701542, "mean_action_processing_ms": 0.08833743422423058, "mean_env_wait_ms": 0.989201365226064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010716915130615234, "StateBufferConnector_ms": 0.0021696090698242188, "ViewRequirementAgentConnector_ms": 0.13511180877685547}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.034465661519789}, "default_policy": {"total_loss": 4.034465661519789, "policy_loss": 0.012364849681034684, "vf_loss": 4.019512268845574, "vf_loss_unclipped": 7.218803058509366, "vf_explained_var": 0.03977768309414387, "entropy": 5.84011260420084, "mean_kl_loss": 0.01154860177757655, "gradients_default_optimizer_global_norm": 24.902679279446602, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.9573732550013838, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -24.09870285267294, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2823085905373638, "mean_inference_ms": 0.6339663830205491, "mean_action_processing_ms": 0.09345007096809305, "mean_env_wait_ms": 1.032788451128726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01688241958618164, "StateBufferConnector_ms": 0.0023627281188964844, "ViewRequirementAgentConnector_ms": 0.14062464237213135}}, "episode_reward_max": -1.9573732550013838, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -24.09870285267294, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2823085905373638, "mean_inference_ms": 0.6339663830205491, "mean_action_processing_ms": 0.09345007096809305, "mean_env_wait_ms": 1.032788451128726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01688241958618164, "StateBufferConnector_ms": 0.0023627281188964844, "ViewRequirementAgentConnector_ms": 0.14062464237213135}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 887.0501456673414, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4096, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 582.042, "sample_time_ms": 273.787, "synch_weights_time_ms": 2.519}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 40, "training_iteration": 8, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-43", "timestamp": 1690476523, "time_this_iter_s": 0.9629058837890625, "time_total_s": 7.7775490283966064, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 7.7775490283966064, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 5.55, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -26.43651605652923, "episode_reward_min": -33.60846271915678, "episode_reward_mean": -30.022489387843006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.60846271915678, -26.43651605652923], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26055563164710466, "mean_inference_ms": 0.5886435574918637, "mean_action_processing_ms": 0.08833838594681286, "mean_env_wait_ms": 0.9891646627185743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010466575622558594, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.13599395751953125}}, "episode_reward_max": -26.43651605652923, "episode_reward_min": -33.60846271915678, "episode_reward_mean": -30.022489387843006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.60846271915678, -26.43651605652923], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26055563164710466, "mean_inference_ms": 0.5886435574918637, "mean_action_processing_ms": 0.08833838594681286, "mean_env_wait_ms": 0.9891646627185743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010466575622558594, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.13599395751953125}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 3.9656644499045797}, "default_policy": {"total_loss": 3.9656644499045797, "policy_loss": 0.0035877363989129663, "vf_loss": 3.9611040025920374, "vf_loss_unclipped": 5.768517290052841, "vf_explained_var": -0.10840996680781245, "entropy": 5.917955998331308, "mean_kl_loss": 0.006201301191566699, "gradients_default_optimizer_global_norm": 27.231767878867686, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.9573732550013838, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -23.79701146055319, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2821153532047122, "mean_inference_ms": 0.6339032059544487, "mean_action_processing_ms": 0.09344183109096767, "mean_env_wait_ms": 1.0338690556077208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016323544762351296, "StateBufferConnector_ms": 0.0023462555625221944, "ViewRequirementAgentConnector_ms": 0.140192833813754}}, "episode_reward_max": -1.9573732550013838, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -23.79701146055319, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2821153532047122, "mean_inference_ms": 0.6339032059544487, "mean_action_processing_ms": 0.09344183109096767, "mean_env_wait_ms": 1.0338690556077208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016323544762351296, "StateBufferConnector_ms": 0.0023462555625221944, "ViewRequirementAgentConnector_ms": 0.140192833813754}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4608, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 865.6663617831694, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4608, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4608, "timers": {"training_iteration_time_ms": 583.085, "sample_time_ms": 274.874, "synch_weights_time_ms": 2.521}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 44, "training_iteration": 9, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-44", "timestamp": 1690476524, "time_this_iter_s": 0.9806792736053467, "time_total_s": 8.758228302001953, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 8.758228302001953, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -21.140058230268316, "episode_reward_min": -27.23813397291441, "episode_reward_mean": -24.189096101591364, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.140058230268316, -27.23813397291441], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26042815269916314, "mean_inference_ms": 0.5883739210259372, "mean_action_processing_ms": 0.08825240642770656, "mean_env_wait_ms": 0.9911799061483052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01024007797241211, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.1342296600341797}}, "episode_reward_max": -21.140058230268316, "episode_reward_min": -27.23813397291441, "episode_reward_mean": -24.189096101591364, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.140058230268316, -27.23813397291441], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26042815269916314, "mean_inference_ms": 0.5883739210259372, "mean_action_processing_ms": 0.08825240642770656, "mean_env_wait_ms": 0.9911799061483052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01024007797241211, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.1342296600341797}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.238382468291093}, "default_policy": {"total_loss": 4.238382468291093, "policy_loss": 0.006710843910695985, "vf_loss": 4.227721855815616, "vf_loss_unclipped": 31.34410223441955, "vf_explained_var": 0.1049090945161879, "entropy": 6.052733976393938, "mean_kl_loss": 0.016192311894997147, "gradients_default_optimizer_global_norm": 30.462004091590643, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.9573732550013838, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -23.259254314202252, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28184779462053483, "mean_inference_ms": 0.6336833883400416, "mean_action_processing_ms": 0.09340642682823556, "mean_env_wait_ms": 1.0348816623866741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015846888224283855, "StateBufferConnector_ms": 0.002326071262359619, "ViewRequirementAgentConnector_ms": 0.13980517784754434}}, "episode_reward_max": -1.9573732550013838, "episode_reward_min": -46.921570175060104, "episode_reward_mean": -23.259254314202252, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28184779462053483, "mean_inference_ms": 0.6336833883400416, "mean_action_processing_ms": 0.09340642682823556, "mean_env_wait_ms": 1.0348816623866741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015846888224283855, "StateBufferConnector_ms": 0.002326071262359619, "ViewRequirementAgentConnector_ms": 0.13980517784754434}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 0, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 892.5534696591853, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 5120, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 582.138, "sample_time_ms": 274.087, "synch_weights_time_ms": 2.495}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 48, "training_iteration": 10, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-45", "timestamp": 1690476525, "time_this_iter_s": 0.9664690494537354, "time_total_s": 9.724697351455688, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 9.724697351455688, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -22.076962775721853, "episode_reward_min": -30.01944130288973, "episode_reward_mean": -26.048202039305792, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.01944130288973, -22.076962775721853], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2602983853428107, "mean_inference_ms": 0.5882660511784638, "mean_action_processing_ms": 0.08818725194242097, "mean_env_wait_ms": 0.9930260557307269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010192394256591797, "StateBufferConnector_ms": 0.0022172927856445312, "ViewRequirementAgentConnector_ms": 0.13425350189208984}}, "episode_reward_max": -22.076962775721853, "episode_reward_min": -30.01944130288973, "episode_reward_mean": -26.048202039305792, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.01944130288973, -22.076962775721853], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2602983853428107, "mean_inference_ms": 0.5882660511784638, "mean_action_processing_ms": 0.08818725194242097, "mean_env_wait_ms": 0.9930260557307269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010192394256591797, "StateBufferConnector_ms": 0.0022172927856445312, "ViewRequirementAgentConnector_ms": 0.13425350189208984}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.5014820773249085}, "default_policy": {"total_loss": 4.5014820773249085, "policy_loss": 1.7397236661054194e-05, "vf_loss": 4.500209428369999, "vf_loss_unclipped": 7.304762594401836, "vf_explained_var": 0.009560780134052038, "entropy": 6.082345720380545, "mean_kl_loss": 0.007225454931813147, "gradients_default_optimizer_global_norm": 26.60601081326604, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.44432608545716, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2814142667470015, "mean_inference_ms": 0.6330685878389568, "mean_action_processing_ms": 0.09330397780913101, "mean_env_wait_ms": 1.0360547410398422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015147243227277483, "StateBufferConnector_ms": 0.0023130859647478375, "ViewRequirementAgentConnector_ms": 0.13976054532187326}}, "episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.44432608545716, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2814142667470015, "mean_inference_ms": 0.6330685878389568, "mean_action_processing_ms": 0.09330397780913101, "mean_env_wait_ms": 1.0360547410398422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015147243227277483, "StateBufferConnector_ms": 0.0023130859647478375, "ViewRequirementAgentConnector_ms": 0.13976054532187326}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 0, "num_env_steps_sampled": 5632, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 896.2461079251296, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 5632, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 5632, "timers": {"training_iteration_time_ms": 579.8, "sample_time_ms": 272.523, "synch_weights_time_ms": 2.437}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 56, "training_iteration": 11, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-46", "timestamp": 1690476526, "time_this_iter_s": 0.9648866653442383, "time_total_s": 10.689584016799927, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 10.689584016799927, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -17.382092119593374, "episode_reward_min": -33.11400819493049, "episode_reward_mean": -25.248050157261932, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.11400819493049, -17.382092119593374], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26024604330257495, "mean_inference_ms": 0.5882315613835218, "mean_action_processing_ms": 0.08814437148075509, "mean_env_wait_ms": 0.9954089872144948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011277198791503906, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13556480407714844}}, "episode_reward_max": -17.382092119593374, "episode_reward_min": -33.11400819493049, "episode_reward_mean": -25.248050157261932, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.11400819493049, -17.382092119593374], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26024604330257495, "mean_inference_ms": 0.5882315613835218, "mean_action_processing_ms": 0.08814437148075509, "mean_env_wait_ms": 0.9954089872144948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011277198791503906, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13556480407714844}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 3.4320576966856606}, "default_policy": {"total_loss": 3.4320576966856606, "policy_loss": -0.0032356023439206183, "vf_loss": 3.434995305724442, "vf_loss_unclipped": 3.7468206733465195, "vf_explained_var": -0.011663653887808323, "entropy": 5.983901169151068, "mean_kl_loss": 0.00398535451989801, "gradients_default_optimizer_global_norm": 38.7134007178247, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.030553676046477, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2812429456458018, "mean_inference_ms": 0.6329678987407201, "mean_action_processing_ms": 0.09328052741929778, "mean_env_wait_ms": 1.0369887578659907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014838774998982748, "StateBufferConnector_ms": 0.002305110295613607, "ViewRequirementAgentConnector_ms": 0.13951500256856283}}, "episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.030553676046477, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2812429456458018, "mean_inference_ms": 0.6329678987407201, "mean_action_processing_ms": 0.09328052741929778, "mean_env_wait_ms": 1.0369887578659907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014838774998982748, "StateBufferConnector_ms": 0.002305110295613607, "ViewRequirementAgentConnector_ms": 0.13951500256856283}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 0, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 847.5046856809096, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 6144, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 581.302, "sample_time_ms": 273.762, "synch_weights_time_ms": 2.437}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 60, "training_iteration": 12, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-47", "timestamp": 1690476527, "time_this_iter_s": 0.999976634979248, "time_total_s": 11.689560651779175, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 11.689560651779175, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -26.744625062357738, "episode_reward_min": -36.42815442507408, "episode_reward_mean": -31.586389743715905, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.744625062357738, -36.42815442507408], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.260375546107426, "mean_inference_ms": 0.5886008399397261, "mean_action_processing_ms": 0.08814915103758358, "mean_env_wait_ms": 0.9923179256874798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010287761688232422, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.136566162109375}}, "episode_reward_max": -26.744625062357738, "episode_reward_min": -36.42815442507408, "episode_reward_mean": -31.586389743715905, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.744625062357738, -36.42815442507408], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.260375546107426, "mean_inference_ms": 0.5886008399397261, "mean_action_processing_ms": 0.08814915103758358, "mean_env_wait_ms": 0.9923179256874798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010287761688232422, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.136566162109375}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.851084279303905}, "default_policy": {"total_loss": 5.851084279303905, "policy_loss": 0.004179711613687687, "vf_loss": 5.847079798695631, "vf_loss_unclipped": 15.091186981764622, "vf_explained_var": -0.04047913057729602, "entropy": 5.933758839964867, "mean_kl_loss": 0.004765444630038473, "gradients_default_optimizer_global_norm": 26.978738555684686, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.195223670254254, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2810921069116195, "mean_inference_ms": 0.632967488850344, "mean_action_processing_ms": 0.09327154357950461, "mean_env_wait_ms": 1.0380654204753792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014583021402359009, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.1394260674715042}}, "episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.195223670254254, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2810921069116195, "mean_inference_ms": 0.632967488850344, "mean_action_processing_ms": 0.09327154357950461, "mean_env_wait_ms": 1.0380654204753792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014583021402359009, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.1394260674715042}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 0, "num_env_steps_sampled": 6656, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 871.9410867859012, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 6656, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 6656, "timers": {"training_iteration_time_ms": 583.104, "sample_time_ms": 275.445, "synch_weights_time_ms": 2.439}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 64, "training_iteration": 13, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-48", "timestamp": 1690476528, "time_this_iter_s": 0.9712584018707275, "time_total_s": 12.660819053649902, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 12.660819053649902, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -5.567229131620858, "episode_reward_min": -23.88519243331572, "episode_reward_mean": -14.72621078246829, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.88519243331572, -5.567229131620858], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26052366704099816, "mean_inference_ms": 0.5888620558401296, "mean_action_processing_ms": 0.08814456589687555, "mean_env_wait_ms": 0.9939572675787351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010478496551513672, "StateBufferConnector_ms": 0.002181529998779297, "ViewRequirementAgentConnector_ms": 0.13637542724609375}}, "episode_reward_max": -5.567229131620858, "episode_reward_min": -23.88519243331572, "episode_reward_mean": -14.72621078246829, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.88519243331572, -5.567229131620858], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26052366704099816, "mean_inference_ms": 0.5888620558401296, "mean_action_processing_ms": 0.08814456589687555, "mean_env_wait_ms": 0.9939572675787351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010478496551513672, "StateBufferConnector_ms": 0.002181529998779297, "ViewRequirementAgentConnector_ms": 0.13637542724609375}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.075194129021838}, "default_policy": {"total_loss": 5.075194129021838, "policy_loss": 0.0012390906340442598, "vf_loss": 5.07440599281108, "vf_loss_unclipped": 12.41564755368745, "vf_explained_var": 0.01489987876266241, "entropy": 5.8078342862427235, "mean_kl_loss": 0.005602387839644507, "gradients_default_optimizer_global_norm": 22.428871325217187, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.238951098411768, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28093305731620793, "mean_inference_ms": 0.632938608373917, "mean_action_processing_ms": 0.09325818881852627, "mean_env_wait_ms": 1.0390180797624193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014365420621984145, "StateBufferConnector_ms": 0.002292324514950023, "ViewRequirementAgentConnector_ms": 0.13927852406221278}}, "episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.238951098411768, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28093305731620793, "mean_inference_ms": 0.632938608373917, "mean_action_processing_ms": 0.09325818881852627, "mean_env_wait_ms": 1.0390180797624193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014365420621984145, "StateBufferConnector_ms": 0.002292324514950023, "ViewRequirementAgentConnector_ms": 0.13927852406221278}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 0, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 888.905116365706, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 7168, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 583.31, "sample_time_ms": 275.697, "synch_weights_time_ms": 2.448}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 68, "training_iteration": 14, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-49", "timestamp": 1690476529, "time_this_iter_s": 0.9723961353302002, "time_total_s": 13.633215188980103, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 13.633215188980103, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -25.27082411439679, "episode_reward_min": -47.22111916876229, "episode_reward_mean": -36.245971641579544, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-47.22111916876229, -25.27082411439679], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26042292174479437, "mean_inference_ms": 0.5888331139020148, "mean_action_processing_ms": 0.0881080188897402, "mean_env_wait_ms": 0.9920171243832214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010263919830322266, "StateBufferConnector_ms": 0.0020623207092285156, "ViewRequirementAgentConnector_ms": 0.1372694969177246}}, "episode_reward_max": -25.27082411439679, "episode_reward_min": -47.22111916876229, "episode_reward_mean": -36.245971641579544, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-47.22111916876229, -25.27082411439679], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26042292174479437, "mean_inference_ms": 0.5888331139020148, "mean_action_processing_ms": 0.0881080188897402, "mean_env_wait_ms": 0.9920171243832214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010263919830322266, "StateBufferConnector_ms": 0.0020623207092285156, "ViewRequirementAgentConnector_ms": 0.1372694969177246}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 3.8204374542692676}, "default_policy": {"total_loss": 3.8204374542692676, "policy_loss": 0.016381112349336036, "vf_loss": 3.8037604758283123, "vf_loss_unclipped": 10.645270015462302, "vf_explained_var": 0.005956454202532768, "entropy": 5.976422216743231, "mean_kl_loss": 0.01589789694804722, "gradients_default_optimizer_global_norm": 32.135764512233436, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.584172588144845, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28072008987920016, "mean_inference_ms": 0.6328647925381783, "mean_action_processing_ms": 0.09323153372156763, "mean_env_wait_ms": 1.040373595517282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014299781698929636, "StateBufferConnector_ms": 0.0023321101540013365, "ViewRequirementAgentConnector_ms": 0.14160432313617907}}, "episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.584172588144845, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28072008987920016, "mean_inference_ms": 0.6328647925381783, "mean_action_processing_ms": 0.09323153372156763, "mean_env_wait_ms": 1.040373595517282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014299781698929636, "StateBufferConnector_ms": 0.0023321101540013365, "ViewRequirementAgentConnector_ms": 0.14160432313617907}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 0, "num_env_steps_sampled": 7680, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 888.6156392577861, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 7680, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 7680, "timers": {"training_iteration_time_ms": 582.961, "sample_time_ms": 275.19, "synch_weights_time_ms": 2.42}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 76, "training_iteration": 15, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-50", "timestamp": 1690476530, "time_this_iter_s": 0.9607255458831787, "time_total_s": 14.593940734863281, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 14.593940734863281, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 6.5, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -27.375754761290544, "episode_reward_min": -32.423632401301624, "episode_reward_mean": -29.899693581296084, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.423632401301624, -27.375754761290544], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2603702193608473, "mean_inference_ms": 0.5887797086620956, "mean_action_processing_ms": 0.08808475328735618, "mean_env_wait_ms": 0.9941350888624968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010204315185546875, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13529062271118164}}, "episode_reward_max": -27.375754761290544, "episode_reward_min": -32.423632401301624, "episode_reward_mean": -29.899693581296084, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.423632401301624, -27.375754761290544], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2603702193608473, "mean_inference_ms": 0.5887797086620956, "mean_action_processing_ms": 0.08808475328735618, "mean_env_wait_ms": 0.9941350888624968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010204315185546875, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13529062271118164}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 2.122683964060343}, "default_policy": {"total_loss": 2.122683964060343, "policy_loss": 0.004546509393549059, "vf_loss": 2.1179321494009855, "vf_loss_unclipped": 13.966901152586615, "vf_explained_var": -0.08626032061874866, "entropy": 5.939126558601856, "mean_kl_loss": 0.014615782764963114, "gradients_default_optimizer_global_norm": 17.14859885815531, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.70772462790732, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28060463381402645, "mean_inference_ms": 0.6328059509095747, "mean_action_processing_ms": 0.0932133770356912, "mean_env_wait_ms": 1.0409374424836373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014135241508483887, "StateBufferConnector_ms": 0.0023248791694641113, "ViewRequirementAgentConnector_ms": 0.1414191722869873}}, "episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.70772462790732, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28060463381402645, "mean_inference_ms": 0.6328059509095747, "mean_action_processing_ms": 0.0932133770356912, "mean_env_wait_ms": 1.0409374424836373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014135241508483887, "StateBufferConnector_ms": 0.0023248791694641113, "ViewRequirementAgentConnector_ms": 0.1414191722869873}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 887.0373215275581, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8192, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 583.05, "sample_time_ms": 275.243, "synch_weights_time_ms": 2.374}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 80, "training_iteration": 16, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-51", "timestamp": 1690476531, "time_this_iter_s": 0.9740779399871826, "time_total_s": 15.568018674850464, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 15.568018674850464, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 7.6, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -10.34627206938324, "episode_reward_min": -26.653267347757172, "episode_reward_mean": -18.499769708570206, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.653267347757172, -10.34627206938324], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26004428689671205, "mean_inference_ms": 0.5880465615465164, "mean_action_processing_ms": 0.08794960643361155, "mean_env_wait_ms": 0.9909899435965883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010061264038085938, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.13428926467895508}}, "episode_reward_max": -10.34627206938324, "episode_reward_min": -26.653267347757172, "episode_reward_mean": -18.499769708570206, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.653267347757172, -10.34627206938324], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26004428689671205, "mean_inference_ms": 0.5880465615465164, "mean_action_processing_ms": 0.08794960643361155, "mean_env_wait_ms": 0.9909899435965883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010061264038085938, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.13428926467895508}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 2.970944990753196}, "default_policy": {"total_loss": 2.970944990753196, "policy_loss": 0.0012633018668566365, "vf_loss": 2.969920257863123, "vf_loss_unclipped": 8.526392127212603, "vf_explained_var": 0.004997061099857092, "entropy": 6.111156851053238, "mean_kl_loss": 0.009041514355374147, "gradients_default_optimizer_global_norm": 23.150631837313995, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.39814133478384, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2804841123671202, "mean_inference_ms": 0.632750411347953, "mean_action_processing_ms": 0.09319584868962467, "mean_env_wait_ms": 1.0414081853451602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01398211433773949, "StateBufferConnector_ms": 0.0023211751665387836, "ViewRequirementAgentConnector_ms": 0.14121532440185547}}, "episode_reward_max": -1.9573732550013838, "episode_reward_min": -61.85649583558122, "episode_reward_mean": -23.39814133478384, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2804841123671202, "mean_inference_ms": 0.632750411347953, "mean_action_processing_ms": 0.09319584868962467, "mean_env_wait_ms": 1.0414081853451602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01398211433773949, "StateBufferConnector_ms": 0.0023211751665387836, "ViewRequirementAgentConnector_ms": 0.14121532440185547}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8704, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 888.5299725474214, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8704, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8704, "timers": {"training_iteration_time_ms": 581.027, "sample_time_ms": 273.114, "synch_weights_time_ms": 2.42}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 84, "training_iteration": 17, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-52", "timestamp": 1690476532, "time_this_iter_s": 0.9521241188049316, "time_total_s": 16.520142793655396, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 16.520142793655396, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -15.725004923048783, "episode_reward_min": -28.77203195217708, "episode_reward_mean": -22.24851843761293, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.725004923048783, -28.77203195217708], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2601062612578592, "mean_inference_ms": 0.5866989960971061, "mean_action_processing_ms": 0.08775597974612494, "mean_env_wait_ms": 0.9882976465243759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010275840759277344, "StateBufferConnector_ms": 0.0020503997802734375, "ViewRequirementAgentConnector_ms": 0.14613866806030273}}, "episode_reward_max": -15.725004923048783, "episode_reward_min": -28.77203195217708, "episode_reward_mean": -22.24851843761293, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.725004923048783, -28.77203195217708], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2601062612578592, "mean_inference_ms": 0.5866989960971061, "mean_action_processing_ms": 0.08775597974612494, "mean_env_wait_ms": 0.9882976465243759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010275840759277344, "StateBufferConnector_ms": 0.0020503997802734375, "ViewRequirementAgentConnector_ms": 0.14613866806030273}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.6671244200078945}, "default_policy": {"total_loss": 4.6671244200078945, "policy_loss": 0.020627354038879275, "vf_loss": 4.642429941362934, "vf_loss_unclipped": 201.52219629383762, "vf_explained_var": 0.021871473640203476, "entropy": 6.025359466671944, "mean_kl_loss": 0.06627881839392558, "gradients_default_optimizer_global_norm": 17.82740778476, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -24.027498520702533, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2803131481682825, "mean_inference_ms": 0.6326476894356151, "mean_action_processing_ms": 0.0931573737208934, "mean_env_wait_ms": 1.0421874702645868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013723580733589504, "StateBufferConnector_ms": 0.0023168066273564878, "ViewRequirementAgentConnector_ms": 0.14146592306054157}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -24.027498520702533, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2803131481682825, "mean_inference_ms": 0.6326476894356151, "mean_action_processing_ms": 0.0931573737208934, "mean_env_wait_ms": 1.0421874702645868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013723580733589504, "StateBufferConnector_ms": 0.0023168066273564878, "ViewRequirementAgentConnector_ms": 0.14146592306054157}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 0, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 887.207729652216, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 9216, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 581.017, "sample_time_ms": 274.009, "synch_weights_time_ms": 2.403}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 92, "training_iteration": 18, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-53", "timestamp": 1690476533, "time_this_iter_s": 0.9520905017852783, "time_total_s": 17.472233295440674, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 17.472233295440674, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 6.1, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -31.71750414803417, "episode_reward_min": -42.97792798339225, "episode_reward_mean": -37.34771606571321, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.71750414803417, -42.97792798339225], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26016535178136585, "mean_inference_ms": 0.5868961546992478, "mean_action_processing_ms": 0.08774826132100183, "mean_env_wait_ms": 0.9886395520393675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010371208190917969, "StateBufferConnector_ms": 0.002181529998779297, "ViewRequirementAgentConnector_ms": 0.13573169708251953}}, "episode_reward_max": -31.71750414803417, "episode_reward_min": -42.97792798339225, "episode_reward_mean": -37.34771606571321, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.71750414803417, -42.97792798339225], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26016535178136585, "mean_inference_ms": 0.5868961546992478, "mean_action_processing_ms": 0.08774826132100183, "mean_env_wait_ms": 0.9886395520393675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010371208190917969, "StateBufferConnector_ms": 0.002181529998779297, "ViewRequirementAgentConnector_ms": 0.13573169708251953}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.305854415986687}, "default_policy": {"total_loss": 5.305854415986687, "policy_loss": 0.003163891815347597, "vf_loss": 5.302734918252099, "vf_loss_unclipped": 10.29298340837704, "vf_explained_var": -0.012772627174854279, "entropy": 6.185732468962669, "mean_kl_loss": 0.007853570113866226, "gradients_default_optimizer_global_norm": 25.21777501842007, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -23.61756546620708, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2802202664964979, "mean_inference_ms": 0.6325819460400738, "mean_action_processing_ms": 0.09313585521129826, "mean_env_wait_ms": 1.0424772411312482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013593584299087524, "StateBufferConnector_ms": 0.0023089349269866943, "ViewRequirementAgentConnector_ms": 0.14121209581693014}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -23.61756546620708, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2802202664964979, "mean_inference_ms": 0.6325819460400738, "mean_action_processing_ms": 0.09313585521129826, "mean_env_wait_ms": 1.0424772411312482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013593584299087524, "StateBufferConnector_ms": 0.0023089349269866943, "ViewRequirementAgentConnector_ms": 0.14121209581693014}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 0, "num_env_steps_sampled": 9728, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 916.5080023814452, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 9728, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 9728, "timers": {"training_iteration_time_ms": 577.736, "sample_time_ms": 272.326, "synch_weights_time_ms": 2.43}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 96, "training_iteration": 19, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-54", "timestamp": 1690476534, "time_this_iter_s": 0.950087308883667, "time_total_s": 18.42232060432434, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 18.42232060432434, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -15.165300813410388, "episode_reward_min": -49.626815835382715, "episode_reward_mean": -32.39605832439655, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.626815835382715, -15.165300813410388], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2603660193540787, "mean_inference_ms": 0.5872593436113628, "mean_action_processing_ms": 0.08781294142177956, "mean_env_wait_ms": 0.9886973561480236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010418891906738281, "StateBufferConnector_ms": 0.0020742416381835938, "ViewRequirementAgentConnector_ms": 0.13818740844726562}}, "episode_reward_max": -15.165300813410388, "episode_reward_min": -49.626815835382715, "episode_reward_mean": -32.39605832439655, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.626815835382715, -15.165300813410388], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2603660193540787, "mean_inference_ms": 0.5872593436113628, "mean_action_processing_ms": 0.08781294142177956, "mean_env_wait_ms": 0.9886973561480236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010418891906738281, "StateBufferConnector_ms": 0.0020742416381835938, "ViewRequirementAgentConnector_ms": 0.13818740844726562}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.753115974119282}, "default_policy": {"total_loss": 4.753115974119282, "policy_loss": -0.0015961299068294466, "vf_loss": 4.754836310580686, "vf_loss_unclipped": 14.80172283662887, "vf_explained_var": -0.049403206910938025, "entropy": 6.306057199835777, "mean_kl_loss": 0.00730342274343343, "gradients_default_optimizer_global_norm": 30.194222756661475, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -23.59861205812446, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2801308179911328, "mean_inference_ms": 0.6325458214204144, "mean_action_processing_ms": 0.09311972254735751, "mean_env_wait_ms": 1.0427540585626183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013470649719238281, "StateBufferConnector_ms": 0.002301454544067383, "ViewRequirementAgentConnector_ms": 0.14097118377685547}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -23.59861205812446, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.44963015258508, -15.745313472212617, -19.08832739380124, -27.30752167268913, -43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2801308179911328, "mean_inference_ms": 0.6325458214204144, "mean_action_processing_ms": 0.09311972254735751, "mean_env_wait_ms": 1.0427540585626183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013470649719238281, "StateBufferConnector_ms": 0.002301454544067383, "ViewRequirementAgentConnector_ms": 0.14097118377685547}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 0, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 878.1350469534922, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 10240, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 578.678, "sample_time_ms": 272.873, "synch_weights_time_ms": 2.425}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 100, "training_iteration": 20, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-55", "timestamp": 1690476535, "time_this_iter_s": 0.975203275680542, "time_total_s": 19.397523880004883, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 19.397523880004883, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 6.5, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -14.298733380595888, "episode_reward_min": -36.54668008198305, "episode_reward_mean": -25.422706731289466, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.298733380595888, -36.54668008198305], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26047567446099607, "mean_inference_ms": 0.5875024248435082, "mean_action_processing_ms": 0.08784359734673013, "mean_env_wait_ms": 0.9884345647806896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010263919830322266, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.1396775245666504}}, "episode_reward_max": -14.298733380595888, "episode_reward_min": -36.54668008198305, "episode_reward_mean": -25.422706731289466, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.298733380595888, -36.54668008198305], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26047567446099607, "mean_inference_ms": 0.5875024248435082, "mean_action_processing_ms": 0.08784359734673013, "mean_env_wait_ms": 0.9884345647806896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010263919830322266, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.1396775245666504}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 2.057508314485858}, "default_policy": {"total_loss": 2.057508314485858, "policy_loss": -0.0054536895477212965, "vf_loss": 2.063324743125122, "vf_loss_unclipped": 3.036314324650448, "vf_explained_var": -0.04115539463236928, "entropy": 6.32100810483098, "mean_kl_loss": 0.005203467982710208, "gradients_default_optimizer_global_norm": 20.45652907434851, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -23.951330986439267, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2796974473398392, "mean_inference_ms": 0.6324666238121356, "mean_action_processing_ms": 0.0930992820896275, "mean_env_wait_ms": 1.0436522932686263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013250350952148438, "StateBufferConnector_ms": 0.0022954940795898438, "ViewRequirementAgentConnector_ms": 0.14081215858459473}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -23.951330986439267, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.6869749603282, -25.48965368454778, -46.921570175060104, -25.762942477936758, -42.84940643628872, -9.598524849277771, -8.265324291859377, -27.719699456776095, -16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2796974473398392, "mean_inference_ms": 0.6324666238121356, "mean_action_processing_ms": 0.0930992820896275, "mean_env_wait_ms": 1.0436522932686263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013250350952148438, "StateBufferConnector_ms": 0.0022954940795898438, "ViewRequirementAgentConnector_ms": 0.14081215858459473}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 0, "num_env_steps_sampled": 10752, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 875.6547166241511, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 10752, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 580.021, "sample_time_ms": 273.731, "synch_weights_time_ms": 2.412}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 104, "training_iteration": 21, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-56", "timestamp": 1690476536, "time_this_iter_s": 0.9746487140655518, "time_total_s": 20.372172594070435, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 20.372172594070435, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 7.4, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -19.586558003771064, "episode_reward_min": -24.583154479196622, "episode_reward_mean": -22.08485624148384, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.583154479196622, -19.586558003771064], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2605211894584228, "mean_inference_ms": 0.5876791528668411, "mean_action_processing_ms": 0.08786978761707212, "mean_env_wait_ms": 0.9908846252968408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010395050048828125, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13681650161743164}}, "episode_reward_max": -19.586558003771064, "episode_reward_min": -24.583154479196622, "episode_reward_mean": -22.08485624148384, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.583154479196622, -19.586558003771064], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2605211894584228, "mean_inference_ms": 0.5876791528668411, "mean_action_processing_ms": 0.08786978761707212, "mean_env_wait_ms": 0.9908846252968408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010395050048828125, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13681650161743164}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.6556456358521245}, "default_policy": {"total_loss": 5.6556456358521245, "policy_loss": -0.007151337340474129, "vf_loss": 5.66316165891476, "vf_loss_unclipped": 31.390584846260026, "vf_explained_var": -0.0050607649609446526, "entropy": 6.5651794746518135, "mean_kl_loss": 0.005511666713118757, "gradients_default_optimizer_global_norm": 15.574101934442297, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -24.003038033582573, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27939023729962614, "mean_inference_ms": 0.6319938680978227, "mean_action_processing_ms": 0.09303344939513046, "mean_env_wait_ms": 1.0448884227959712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013041973114013672, "StateBufferConnector_ms": 0.0023374557495117188, "ViewRequirementAgentConnector_ms": 0.14384198188781738}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -24.003038033582573, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.395803038638515, -16.856954155312906, -42.10133196921985, -38.763006749633576, -28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27939023729962614, "mean_inference_ms": 0.6319938680978227, "mean_action_processing_ms": 0.09303344939513046, "mean_env_wait_ms": 1.0448884227959712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013041973114013672, "StateBufferConnector_ms": 0.0023374557495117188, "ViewRequirementAgentConnector_ms": 0.14384198188781738}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 0, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 869.0585476757616, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 11264, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 578.523, "sample_time_ms": 271.609, "synch_weights_time_ms": 2.403}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 112, "training_iteration": 22, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-57", "timestamp": 1690476537, "time_this_iter_s": 0.9905962944030762, "time_total_s": 21.36276888847351, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 21.36276888847351, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 6.15, "ram_util_percent": 9.7}}
{"evaluation": {"sampler_results": {"episode_reward_max": -23.453676272305287, "episode_reward_min": -30.46049532594562, "episode_reward_mean": -26.95708579912545, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.46049532594562, -23.453676272305287], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26061389270592605, "mean_inference_ms": 0.5879861275752299, "mean_action_processing_ms": 0.08790385746432501, "mean_env_wait_ms": 0.9908668892820409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010669231414794922, "StateBufferConnector_ms": 0.00209808349609375, "ViewRequirementAgentConnector_ms": 0.13724565505981445}}, "episode_reward_max": -23.453676272305287, "episode_reward_min": -30.46049532594562, "episode_reward_mean": -26.95708579912545, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.46049532594562, -23.453676272305287], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26061389270592605, "mean_inference_ms": 0.5879861275752299, "mean_action_processing_ms": 0.08790385746432501, "mean_env_wait_ms": 0.9908668892820409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010669231414794922, "StateBufferConnector_ms": 0.00209808349609375, "ViewRequirementAgentConnector_ms": 0.13724565505981445}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.935330643034831}, "default_policy": {"total_loss": 4.935330643034831, "policy_loss": 0.00028680254763457924, "vf_loss": 4.935271187070612, "vf_loss_unclipped": 10.388183256927732, "vf_explained_var": 0.00864495849236846, "entropy": 6.532301731407642, "mean_kl_loss": 0.006688608573540478, "gradients_default_optimizer_global_norm": 23.73607452493161, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -24.188220021419955, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27940965566308396, "mean_inference_ms": 0.6320636381324237, "mean_action_processing_ms": 0.09302290497628408, "mean_env_wait_ms": 1.0463357906425286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012783288955688477, "StateBufferConnector_ms": 0.002327442169189453, "ViewRequirementAgentConnector_ms": 0.14345288276672363}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -24.188220021419955, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-28.665318060676725, -20.73902019191183, -36.7294288510859, -13.071731464888925, -20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27940965566308396, "mean_inference_ms": 0.6320636381324237, "mean_action_processing_ms": 0.09302290497628408, "mean_env_wait_ms": 1.0463357906425286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012783288955688477, "StateBufferConnector_ms": 0.002327442169189453, "ViewRequirementAgentConnector_ms": 0.14345288276672363}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 0, "num_env_steps_sampled": 11776, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 867.3656191018184, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 11776, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 11776, "timers": {"training_iteration_time_ms": 578.832, "sample_time_ms": 271.543, "synch_weights_time_ms": 2.4}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 116, "training_iteration": 23, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-58", "timestamp": 1690476538, "time_this_iter_s": 0.982276439666748, "time_total_s": 22.34504532814026, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 22.34504532814026, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 9.7}}
{"evaluation": {"sampler_results": {"episode_reward_max": -18.47722158161452, "episode_reward_min": -30.701183597854474, "episode_reward_mean": -24.589202589734498, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.701183597854474, -18.47722158161452], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26066465641999836, "mean_inference_ms": 0.5881523644022831, "mean_action_processing_ms": 0.08791914782755525, "mean_env_wait_ms": 0.9913849249603202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010335445404052734, "StateBufferConnector_ms": 0.0021696090698242188, "ViewRequirementAgentConnector_ms": 0.13782978057861328}}, "episode_reward_max": -18.47722158161452, "episode_reward_min": -30.701183597854474, "episode_reward_mean": -24.589202589734498, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.701183597854474, -18.47722158161452], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26066465641999836, "mean_inference_ms": 0.5881523644022831, "mean_action_processing_ms": 0.08791914782755525, "mean_env_wait_ms": 0.9913849249603202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010335445404052734, "StateBufferConnector_ms": 0.0021696090698242188, "ViewRequirementAgentConnector_ms": 0.13782978057861328}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.585301860352047}, "default_policy": {"total_loss": 4.585301860352047, "policy_loss": 0.008871816040482372, "vf_loss": 4.575898007577052, "vf_loss_unclipped": 12.917115864431253, "vf_explained_var": -0.10842918371781707, "entropy": 6.255676455795765, "mean_kl_loss": 0.013070436355690163, "gradients_default_optimizer_global_norm": 22.564349446445704, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -24.35901760138082, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27905638778782693, "mean_inference_ms": 0.6320976788235749, "mean_action_processing_ms": 0.09301435827164285, "mean_env_wait_ms": 1.0472317182137991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012512922286987305, "StateBufferConnector_ms": 0.0023183822631835938, "ViewRequirementAgentConnector_ms": 0.14304852485656738}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -24.35901760138082, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-20.957742120594308, -30.84441863984749, -35.94126360887602, -24.74068499301695, -15.183687778077193, -37.03040449335746, -4.25627796234273, -10.594472097083482, -19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27905638778782693, "mean_inference_ms": 0.6320976788235749, "mean_action_processing_ms": 0.09301435827164285, "mean_env_wait_ms": 1.0472317182137991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012512922286987305, "StateBufferConnector_ms": 0.0023183822631835938, "ViewRequirementAgentConnector_ms": 0.14304852485656738}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 858.7255368325083, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12288, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 580.857, "sample_time_ms": 273.114, "synch_weights_time_ms": 2.387}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 120, "training_iteration": 24, "trial_id": "6abf4_00000", "date": "2023-07-27_17-48-59", "timestamp": 1690476539, "time_this_iter_s": 0.9902350902557373, "time_total_s": 23.335280418395996, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 23.335280418395996, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 7.3, "ram_util_percent": 9.7}}
{"evaluation": {"sampler_results": {"episode_reward_max": -12.789130593256067, "episode_reward_min": -28.312732266849686, "episode_reward_mean": -20.550931430052877, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.789130593256067, -28.312732266849686], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2608357894613704, "mean_inference_ms": 0.5884481844628389, "mean_action_processing_ms": 0.0879466593253615, "mean_env_wait_ms": 0.9912058630601761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010538101196289062, "StateBufferConnector_ms": 0.0021576881408691406, "ViewRequirementAgentConnector_ms": 0.13478994369506836}}, "episode_reward_max": -12.789130593256067, "episode_reward_min": -28.312732266849686, "episode_reward_mean": -20.550931430052877, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.789130593256067, -28.312732266849686], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2608357894613704, "mean_inference_ms": 0.5884481844628389, "mean_action_processing_ms": 0.0879466593253615, "mean_env_wait_ms": 0.9912058630601761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010538101196289062, "StateBufferConnector_ms": 0.0021576881408691406, "ViewRequirementAgentConnector_ms": 0.13478994369506836}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 7.399608957115561}, "default_policy": {"total_loss": 7.399608957115561, "policy_loss": 0.002021995620452799, "vf_loss": 7.397143383510411, "vf_loss_unclipped": 85.19335846975446, "vf_explained_var": -0.002059833612293005, "entropy": 6.638465546071529, "mean_kl_loss": 0.012794808725402618, "gradients_default_optimizer_global_norm": 11.86247142124921, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -25.30761895435814, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.278869955590994, "mean_inference_ms": 0.6321082834876628, "mean_action_processing_ms": 0.09296003899092245, "mean_env_wait_ms": 1.0488713711573743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012049674987792969, "StateBufferConnector_ms": 0.002310037612915039, "ViewRequirementAgentConnector_ms": 0.14301776885986328}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -25.30761895435814, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.106806728839747, -13.543612089533939, -30.729853390743674, -14.773531295560192, -16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.278869955590994, "mean_inference_ms": 0.6321082834876628, "mean_action_processing_ms": 0.09296003899092245, "mean_env_wait_ms": 1.0488713711573743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012049674987792969, "StateBufferConnector_ms": 0.002310037612915039, "ViewRequirementAgentConnector_ms": 0.14301776885986328}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12800, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 881.3624378732223, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12800, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 581.331, "sample_time_ms": 273.672, "synch_weights_time_ms": 2.374}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 128, "training_iteration": 25, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-00", "timestamp": 1690476540, "time_this_iter_s": 0.9728066921234131, "time_total_s": 24.30808711051941, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 24.30808711051941, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 6.1, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -16.779709352838033, "episode_reward_min": -41.229359991771496, "episode_reward_mean": -29.004534672304764, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.779709352838033, -41.229359991771496], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2607736787390787, "mean_inference_ms": 0.5883803346527927, "mean_action_processing_ms": 0.0879253889134104, "mean_env_wait_ms": 0.9906254830531858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010192394256591797, "StateBufferConnector_ms": 0.00209808349609375, "ViewRequirementAgentConnector_ms": 0.13390779495239258}}, "episode_reward_max": -16.779709352838033, "episode_reward_min": -41.229359991771496, "episode_reward_mean": -29.004534672304764, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.779709352838033, -41.229359991771496], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2607736787390787, "mean_inference_ms": 0.5883803346527927, "mean_action_processing_ms": 0.0879253889134104, "mean_env_wait_ms": 0.9906254830531858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010192394256591797, "StateBufferConnector_ms": 0.00209808349609375, "ViewRequirementAgentConnector_ms": 0.13390779495239258}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 3.792560416739434}, "default_policy": {"total_loss": 3.792560416739434, "policy_loss": 0.011150953883770853, "vf_loss": 3.780775446255575, "vf_loss_unclipped": 7.63818602990068, "vf_explained_var": 0.020100260619074106, "entropy": 6.26983755081892, "mean_kl_loss": 0.013995724564097145, "gradients_default_optimizer_global_norm": 33.566282727289945, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -25.382244511110745, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27879369898160816, "mean_inference_ms": 0.6320400524665366, "mean_action_processing_ms": 0.09292182115409935, "mean_env_wait_ms": 1.0492659047431976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011809110641479492, "StateBufferConnector_ms": 0.0023043155670166016, "ViewRequirementAgentConnector_ms": 0.14296483993530273}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -25.382244511110745, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.697096204257747, -1.9573732550013838, -30.10319225746479, -27.178563921261055, -39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27879369898160816, "mean_inference_ms": 0.6320400524665366, "mean_action_processing_ms": 0.09292182115409935, "mean_env_wait_ms": 1.0492659047431976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011809110641479492, "StateBufferConnector_ms": 0.0023043155670166016, "ViewRequirementAgentConnector_ms": 0.14296483993530273}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 0, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 872.7795356330454, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 13312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 582.274, "sample_time_ms": 274.45, "synch_weights_time_ms": 2.355}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 132, "training_iteration": 26, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-01", "timestamp": 1690476541, "time_this_iter_s": 0.9729709625244141, "time_total_s": 25.281058073043823, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 25.281058073043823, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -3.975841406427619, "episode_reward_min": -18.18245303464081, "episode_reward_mean": -11.079147220534216, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.975841406427619, -18.18245303464081], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26050445614556783, "mean_inference_ms": 0.5878205432690552, "mean_action_processing_ms": 0.08782270417745809, "mean_env_wait_ms": 0.9895897511971524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009930133819580078, "StateBufferConnector_ms": 0.0020623207092285156, "ViewRequirementAgentConnector_ms": 0.13152360916137695}}, "episode_reward_max": -3.975841406427619, "episode_reward_min": -18.18245303464081, "episode_reward_mean": -11.079147220534216, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.975841406427619, -18.18245303464081], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26050445614556783, "mean_inference_ms": 0.5878205432690552, "mean_action_processing_ms": 0.08782270417745809, "mean_env_wait_ms": 0.9895897511971524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009930133819580078, "StateBufferConnector_ms": 0.0020623207092285156, "ViewRequirementAgentConnector_ms": 0.13152360916137695}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.449244199953682}, "default_policy": {"total_loss": 5.449244199953682, "policy_loss": -0.002907256013713777, "vf_loss": 5.452037393137289, "vf_loss_unclipped": 16.886105318575574, "vf_explained_var": 0.0059619382955133915, "entropy": 6.688778284937143, "mean_kl_loss": 0.009932288904792586, "gradients_default_optimizer_global_norm": 17.87741587869823, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -25.632079979034046, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27878942968951476, "mean_inference_ms": 0.6320362227667831, "mean_action_processing_ms": 0.09288856599839633, "mean_env_wait_ms": 1.0497144191865113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011528730392456055, "StateBufferConnector_ms": 0.0022940635681152344, "ViewRequirementAgentConnector_ms": 0.14261627197265625}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -25.632079979034046, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-39.7659392605487, -22.385923236755126, -23.701819715124802, -19.247967553899734, -13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27878942968951476, "mean_inference_ms": 0.6320362227667831, "mean_action_processing_ms": 0.09288856599839633, "mean_env_wait_ms": 1.0497144191865113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011528730392456055, "StateBufferConnector_ms": 0.0022940635681152344, "ViewRequirementAgentConnector_ms": 0.14261627197265625}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 0, "num_env_steps_sampled": 13824, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 878.3767751730999, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 13824, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 13824, "timers": {"training_iteration_time_ms": 582.94, "sample_time_ms": 275.33, "synch_weights_time_ms": 2.324}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 136, "training_iteration": 27, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-02", "timestamp": 1690476542, "time_this_iter_s": 0.9623966217041016, "time_total_s": 26.243454694747925, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 26.243454694747925, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.873993327964236, "episode_reward_min": -13.587792325162301, "episode_reward_mean": -7.730892826563268, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.873993327964236, -13.587792325162301], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2602973679861114, "mean_inference_ms": 0.5874548229101065, "mean_action_processing_ms": 0.08775583017598176, "mean_env_wait_ms": 0.9892114974030255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010192394256591797, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13189315795898438}}, "episode_reward_max": -1.873993327964236, "episode_reward_min": -13.587792325162301, "episode_reward_mean": -7.730892826563268, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.873993327964236, -13.587792325162301], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2602973679861114, "mean_inference_ms": 0.5874548229101065, "mean_action_processing_ms": 0.08775583017598176, "mean_env_wait_ms": 0.9892114974030255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010192394256591797, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13189315795898438}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.22492752422113}, "default_policy": {"total_loss": 5.22492752422113, "policy_loss": -0.006277457578107715, "vf_loss": 5.230407841328997, "vf_loss_unclipped": 14.284723687742371, "vf_explained_var": -0.039617087692022324, "entropy": 6.798349414020777, "mean_kl_loss": 0.016150338091165395, "gradients_default_optimizer_global_norm": 29.3775584846735, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -25.838304006148302, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27860295378643607, "mean_inference_ms": 0.6321154992436053, "mean_action_processing_ms": 0.09287425281876488, "mean_env_wait_ms": 1.050121719352412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011231184005737305, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.1421670913696289}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -25.838304006148302, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.316969958629834, -29.697748460509725, -14.02006975371656, -26.085601984566754, -24.669282926462994, -29.8525144477622, -7.833524877587474, -7.020380565555026, -21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27860295378643607, "mean_inference_ms": 0.6321154992436053, "mean_action_processing_ms": 0.09287425281876488, "mean_env_wait_ms": 1.050121719352412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011231184005737305, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.1421670913696289}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 0, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 888.1257603923913, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 14336, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 582.881, "sample_time_ms": 273.884, "synch_weights_time_ms": 2.307}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 140, "training_iteration": 28, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-03", "timestamp": 1690476543, "time_this_iter_s": 0.960524320602417, "time_total_s": 27.203979015350342, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 27.203979015350342, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -21.567846523964022, "episode_reward_min": -33.64042145946717, "episode_reward_mean": -27.604133991715596, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.567846523964022, -33.64042145946717], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26053035080463716, "mean_inference_ms": 0.5876272017740829, "mean_action_processing_ms": 0.08777428692609067, "mean_env_wait_ms": 0.9896222979133447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010502338409423828, "StateBufferConnector_ms": 0.002372264862060547, "ViewRequirementAgentConnector_ms": 0.13748407363891602}}, "episode_reward_max": -21.567846523964022, "episode_reward_min": -33.64042145946717, "episode_reward_mean": -27.604133991715596, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.567846523964022, -33.64042145946717], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26053035080463716, "mean_inference_ms": 0.5876272017740829, "mean_action_processing_ms": 0.08777428692609067, "mean_env_wait_ms": 0.9896222979133447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010502338409423828, "StateBufferConnector_ms": 0.002372264862060547, "ViewRequirementAgentConnector_ms": 0.13748407363891602}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 3.658518729833304}, "default_policy": {"total_loss": 3.658518729833304, "policy_loss": 0.005147082858456997, "vf_loss": 3.652978978527244, "vf_loss_unclipped": 10.409244011563715, "vf_explained_var": -0.0485527035780251, "entropy": 6.394289717078209, "mean_kl_loss": 0.01201617211236794, "gradients_default_optimizer_global_norm": 17.382516253972426, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -26.624020069808402, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27851617360257364, "mean_inference_ms": 0.6322052043613922, "mean_action_processing_ms": 0.09284630942251688, "mean_env_wait_ms": 1.0507257513622719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011487483978271484, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.14530467987060547}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -26.624020069808402, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.02336480030305, -26.901913301166434, -61.85649583558122, -13.976592073634325, -25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27851617360257364, "mean_inference_ms": 0.6322052043613922, "mean_action_processing_ms": 0.09284630942251688, "mean_env_wait_ms": 1.0507257513622719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011487483978271484, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.14530467987060547}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 0, "num_env_steps_sampled": 14848, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 876.169178846769, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 14848, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 14848, "timers": {"training_iteration_time_ms": 585.453, "sample_time_ms": 275.517, "synch_weights_time_ms": 2.343}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 148, "training_iteration": 29, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-04", "timestamp": 1690476544, "time_this_iter_s": 0.9788601398468018, "time_total_s": 28.182839155197144, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 28.182839155197144, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 6.199999999999999, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -17.697640826032703, "episode_reward_min": -37.94139905701923, "episode_reward_mean": -27.819519941525968, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.94139905701923, -17.697640826032703], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.260580303152091, "mean_inference_ms": 0.5879737082927788, "mean_action_processing_ms": 0.08779874425632837, "mean_env_wait_ms": 0.9901665822801303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01035928726196289, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13682842254638672}}, "episode_reward_max": -17.697640826032703, "episode_reward_min": -37.94139905701923, "episode_reward_mean": -27.819519941525968, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.94139905701923, -17.697640826032703], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.260580303152091, "mean_inference_ms": 0.5879737082927788, "mean_action_processing_ms": 0.08779874425632837, "mean_env_wait_ms": 0.9901665822801303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01035928726196289, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13682842254638672}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 2.736894915928133}, "default_policy": {"total_loss": 2.736894915928133, "policy_loss": 0.0028206424904055893, "vf_loss": 2.734114236689493, "vf_loss_unclipped": 3.885323108665034, "vf_explained_var": -0.009412177838385105, "entropy": 6.539891917258501, "mean_kl_loss": 0.00836460833397723, "gradients_default_optimizer_global_norm": 22.294944105669856, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -26.250268621598437, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27856670210623125, "mean_inference_ms": 0.6323104530116063, "mean_action_processing_ms": 0.09283980061529468, "mean_env_wait_ms": 1.051231034979871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011485815048217773, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.14531183242797852}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -26.250268621598437, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25.33169023741775, -7.047603895460552, -15.57639912891172, -24.723994431417495, -21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27856670210623125, "mean_inference_ms": 0.6323104530116063, "mean_action_processing_ms": 0.09283980061529468, "mean_env_wait_ms": 1.051231034979871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011485815048217773, "StateBufferConnector_ms": 0.0023310184478759766, "ViewRequirementAgentConnector_ms": 0.14531183242797852}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 0, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 895.5822947349369, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 15360, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 584.317, "sample_time_ms": 274.353, "synch_weights_time_ms": 2.346}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 152, "training_iteration": 30, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-05", "timestamp": 1690476545, "time_this_iter_s": 0.9672267436981201, "time_total_s": 29.150065898895264, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 29.150065898895264, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -36.54359797800577, "episode_reward_min": -37.17611740210071, "episode_reward_mean": -36.85985769005324, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.17611740210071, -36.54359797800577], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2605862395260876, "mean_inference_ms": 0.588164985458652, "mean_action_processing_ms": 0.08782346947234285, "mean_env_wait_ms": 0.9902104930019516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010311603546142578, "StateBufferConnector_ms": 0.0020384788513183594, "ViewRequirementAgentConnector_ms": 0.1377701759338379}}, "episode_reward_max": -36.54359797800577, "episode_reward_min": -37.17611740210071, "episode_reward_mean": -36.85985769005324, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.17611740210071, -36.54359797800577], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2605862395260876, "mean_inference_ms": 0.588164985458652, "mean_action_processing_ms": 0.08782346947234285, "mean_env_wait_ms": 0.9902104930019516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010311603546142578, "StateBufferConnector_ms": 0.0020384788513183594, "ViewRequirementAgentConnector_ms": 0.1377701759338379}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.625190291702893}, "default_policy": {"total_loss": 5.625190291702893, "policy_loss": 0.011866047469084151, "vf_loss": 5.612838617758825, "vf_loss_unclipped": 30.722458268748596, "vf_explained_var": -0.014624797739088535, "entropy": 6.736236594617367, "mean_kl_loss": 0.01329838205640499, "gradients_default_optimizer_global_norm": 30.596190730808303, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 15872, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.108593878581225, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2784457406754316, "mean_inference_ms": 0.6324473454972867, "mean_action_processing_ms": 0.0928485405728095, "mean_env_wait_ms": 1.0514013059839171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011460304260253906, "StateBufferConnector_ms": 0.002326488494873047, "ViewRequirementAgentConnector_ms": 0.14493703842163086}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.108593878581225, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.907148378153146, -23.04653239498526, -14.556362849701053, -9.440916154348317, -3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2784457406754316, "mean_inference_ms": 0.6324473454972867, "mean_action_processing_ms": 0.0928485405728095, "mean_env_wait_ms": 1.0514013059839171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011460304260253906, "StateBufferConnector_ms": 0.002326488494873047, "ViewRequirementAgentConnector_ms": 0.14493703842163086}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 0, "num_env_steps_sampled": 15872, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 887.119402430168, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 15872, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 15872, "timers": {"training_iteration_time_ms": 583.561, "sample_time_ms": 273.502, "synch_weights_time_ms": 2.347}, "counters": {"num_env_steps_sampled": 15872, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 156, "training_iteration": 31, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-06", "timestamp": 1690476546, "time_this_iter_s": 0.9686839580535889, "time_total_s": 30.118749856948853, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 30.118749856948853, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -13.257405206175129, "episode_reward_min": -23.8339165899582, "episode_reward_mean": -18.545660898066664, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.8339165899582, -13.257405206175129], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26056219350358617, "mean_inference_ms": 0.5883456505643001, "mean_action_processing_ms": 0.08783577345550256, "mean_env_wait_ms": 0.9908156178180472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010597705841064453, "StateBufferConnector_ms": 0.0020742416381835938, "ViewRequirementAgentConnector_ms": 0.1349925994873047}}, "episode_reward_max": -13.257405206175129, "episode_reward_min": -23.8339165899582, "episode_reward_mean": -18.545660898066664, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.8339165899582, -13.257405206175129], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26056219350358617, "mean_inference_ms": 0.5883456505643001, "mean_action_processing_ms": 0.08783577345550256, "mean_env_wait_ms": 0.9908156178180472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010597705841064453, "StateBufferConnector_ms": 0.0020742416381835938, "ViewRequirementAgentConnector_ms": 0.1349925994873047}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.474992925508559}, "default_policy": {"total_loss": 5.474992925508559, "policy_loss": 0.007805264671333134, "vf_loss": 5.467197171412408, "vf_loss_unclipped": 9.810721061192453, "vf_explained_var": -0.05966259352862835, "entropy": 6.844562154263258, "mean_kl_loss": 0.009041675246351133, "gradients_default_optimizer_global_norm": 34.36217596381903, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.657497747083653, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27839854174364026, "mean_inference_ms": 0.632481201662161, "mean_action_processing_ms": 0.09284001608489215, "mean_env_wait_ms": 1.0514066341447186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01147007942199707, "StateBufferConnector_ms": 0.002324342727661133, "ViewRequirementAgentConnector_ms": 0.14499306678771973}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.657497747083653, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8490703769843675, -34.2742887577534, -35.322035225432465, -29.215699973313406, -48.258648014004926, -7.94414263348293, -15.53373702471259, -24.01783212352748, -21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27839854174364026, "mean_inference_ms": 0.632481201662161, "mean_action_processing_ms": 0.09284001608489215, "mean_env_wait_ms": 1.0514066341447186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01147007942199707, "StateBufferConnector_ms": 0.002324342727661133, "ViewRequirementAgentConnector_ms": 0.14499306678771973}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 882.1335874664192, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16384, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 582.688, "sample_time_ms": 273.072, "synch_weights_time_ms": 2.343}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 160, "training_iteration": 32, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-07", "timestamp": 1690476547, "time_this_iter_s": 0.9752798080444336, "time_total_s": 31.094029664993286, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 31.094029664993286, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 6.1, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -19.377525293462142, "episode_reward_min": -21.88980134266457, "episode_reward_mean": -20.633663318063356, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.377525293462142, -21.88980134266457], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2605778541443583, "mean_inference_ms": 0.5885693290489693, "mean_action_processing_ms": 0.08789587519310077, "mean_env_wait_ms": 0.9905888517414724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010228157043457031, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13521909713745117}}, "episode_reward_max": -19.377525293462142, "episode_reward_min": -21.88980134266457, "episode_reward_mean": -20.633663318063356, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.377525293462142, -21.88980134266457], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2605778541443583, "mean_inference_ms": 0.5885693290489693, "mean_action_processing_ms": 0.08789587519310077, "mean_env_wait_ms": 0.9905888517414724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010228157043457031, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13521909713745117}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.550389260984957}, "default_policy": {"total_loss": 4.550389260984957, "policy_loss": 0.006101092498283833, "vf_loss": 4.544267979877077, "vf_loss_unclipped": 10.952941420914613, "vf_explained_var": 0.062244934029877186, "entropy": 6.513143181800842, "mean_kl_loss": 0.008863535639420661, "gradients_default_optimizer_global_norm": 26.03740737622138, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 16896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.723765799747806, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2783647740037562, "mean_inference_ms": 0.6324692072011628, "mean_action_processing_ms": 0.092813938273896, "mean_env_wait_ms": 1.051058082170362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011632919311523438, "StateBufferConnector_ms": 0.002349376678466797, "ViewRequirementAgentConnector_ms": 0.1462855339050293}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.723765799747806, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.869064877835438, -13.582018637713565, -36.807345847925724, -22.061434048917704, -29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2783647740037562, "mean_inference_ms": 0.6324692072011628, "mean_action_processing_ms": 0.092813938273896, "mean_env_wait_ms": 1.051058082170362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011632919311523438, "StateBufferConnector_ms": 0.002349376678466797, "ViewRequirementAgentConnector_ms": 0.1462855339050293}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 879.3752673976354, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16896, "timers": {"training_iteration_time_ms": 581.882, "sample_time_ms": 272.34, "synch_weights_time_ms": 2.338}, "counters": {"num_env_steps_sampled": 16896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 168, "training_iteration": 33, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-08", "timestamp": 1690476548, "time_this_iter_s": 0.9729094505310059, "time_total_s": 32.06693911552429, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 32.06693911552429, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -10.767703692184172, "episode_reward_min": -23.901079813269998, "episode_reward_mean": -17.334391752727086, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.767703692184172, -23.901079813269998], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26064244390778496, "mean_inference_ms": 0.5887145067800267, "mean_action_processing_ms": 0.08791703508980325, "mean_env_wait_ms": 0.9908899807295471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010538101196289062, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.1397848129272461}}, "episode_reward_max": -10.767703692184172, "episode_reward_min": -23.901079813269998, "episode_reward_mean": -17.334391752727086, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.767703692184172, -23.901079813269998], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26064244390778496, "mean_inference_ms": 0.5887145067800267, "mean_action_processing_ms": 0.08791703508980325, "mean_env_wait_ms": 0.9908899807295471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010538101196289062, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.1397848129272461}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.794487264705822}, "default_policy": {"total_loss": 4.794487264705822, "policy_loss": -0.002739311195909977, "vf_loss": 4.797534022945911, "vf_loss_unclipped": 7.260266773868352, "vf_explained_var": -0.030852927826344967, "entropy": 6.667214348912239, "mean_kl_loss": 0.006156458603527426, "gradients_default_optimizer_global_norm": 33.61865019518882, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.54903010207083, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2783925487670453, "mean_inference_ms": 0.6324800128982333, "mean_action_processing_ms": 0.09279518224180734, "mean_env_wait_ms": 1.05119506279837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011495590209960938, "StateBufferConnector_ms": 0.0023238658905029297, "ViewRequirementAgentConnector_ms": 0.14506912231445312}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.54903010207083, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29.10252566077352, -39.72085544015099, -37.43090726317959, -11.574290230511751, -14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2783925487670453, "mean_inference_ms": 0.6324800128982333, "mean_action_processing_ms": 0.09279518224180734, "mean_env_wait_ms": 1.05119506279837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011495590209960938, "StateBufferConnector_ms": 0.0023238658905029297, "ViewRequirementAgentConnector_ms": 0.14506912231445312}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 0, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 882.0542380205032, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 17408, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 580.305, "sample_time_ms": 270.873, "synch_weights_time_ms": 2.355}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 172, "training_iteration": 34, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-09", "timestamp": 1690476549, "time_this_iter_s": 0.974318265914917, "time_total_s": 33.04125738143921, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 33.04125738143921, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 6.1, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -24.740978160478516, "episode_reward_min": -48.02155205675213, "episode_reward_mean": -36.381265108615324, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.02155205675213, -24.740978160478516], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606066614027586, "mean_inference_ms": 0.5887317889044241, "mean_action_processing_ms": 0.08791365839382391, "mean_env_wait_ms": 0.9917120408405664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010216236114501953, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13530254364013672}}, "episode_reward_max": -24.740978160478516, "episode_reward_min": -48.02155205675213, "episode_reward_mean": -36.381265108615324, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.02155205675213, -24.740978160478516], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606066614027586, "mean_inference_ms": 0.5887317889044241, "mean_action_processing_ms": 0.08791365839382391, "mean_env_wait_ms": 0.9917120408405664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010216236114501953, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13530254364013672}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 3.6090504464227706}, "default_policy": {"total_loss": 3.6090504464227706, "policy_loss": -0.0012994010467082262, "vf_loss": 3.610509777732659, "vf_loss_unclipped": 7.475059999444056, "vf_explained_var": -0.05154111888259649, "entropy": 7.0154804810881615, "mean_kl_loss": 0.00793252321228266, "gradients_default_optimizer_global_norm": 23.051204036921263, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.373744513819414, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2783004892803543, "mean_inference_ms": 0.6325285533132861, "mean_action_processing_ms": 0.09279723712831565, "mean_env_wait_ms": 1.050905276346876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011395454406738281, "StateBufferConnector_ms": 0.002307415008544922, "ViewRequirementAgentConnector_ms": 0.1443486213684082}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.373744513819414, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.674552449376653, -50.080103415673335, -21.71422665441896, -17.75197101410817, -24.986328402155486, -15.618390879769342, -14.341761524535215, -13.879421082796608, -21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2783004892803543, "mean_inference_ms": 0.6325285533132861, "mean_action_processing_ms": 0.09279723712831565, "mean_env_wait_ms": 1.050905276346876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011395454406738281, "StateBufferConnector_ms": 0.002307415008544922, "ViewRequirementAgentConnector_ms": 0.1443486213684082}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 0, "num_env_steps_sampled": 17920, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 870.8329557329631, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 17920, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 17920, "timers": {"training_iteration_time_ms": 581.007, "sample_time_ms": 271.492, "synch_weights_time_ms": 2.352}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 176, "training_iteration": 35, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-10", "timestamp": 1690476550, "time_this_iter_s": 0.9839036464691162, "time_total_s": 34.025161027908325, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 34.025161027908325, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -9.413659105230204, "episode_reward_min": -45.35920294627432, "episode_reward_mean": -27.386431025752263, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.35920294627432, -9.413659105230204], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606147495413336, "mean_inference_ms": 0.5889305752559661, "mean_action_processing_ms": 0.08799132167125903, "mean_env_wait_ms": 0.9916215419040887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010633468627929688, "StateBufferConnector_ms": 0.0021219253540039062, "ViewRequirementAgentConnector_ms": 0.13668537139892578}}, "episode_reward_max": -9.413659105230204, "episode_reward_min": -45.35920294627432, "episode_reward_mean": -27.386431025752263, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.35920294627432, -9.413659105230204], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606147495413336, "mean_inference_ms": 0.5889305752559661, "mean_action_processing_ms": 0.08799132167125903, "mean_env_wait_ms": 0.9916215419040887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010633468627929688, "StateBufferConnector_ms": 0.0021219253540039062, "ViewRequirementAgentConnector_ms": 0.13668537139892578}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 2.304701803896023}, "default_policy": {"total_loss": 2.304701803896023, "policy_loss": 0.009670969215221703, "vf_loss": 2.292319194355514, "vf_loss_unclipped": 35.086825952806976, "vf_explained_var": -0.2867334051989019, "entropy": 6.671820279210806, "mean_kl_loss": 0.03299918796938073, "gradients_default_optimizer_global_norm": 12.294589574448764, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.88809138526358, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782997727713498, "mean_inference_ms": 0.6326155072174877, "mean_action_processing_ms": 0.09278901576257806, "mean_env_wait_ms": 1.050806266032279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011404275894165039, "StateBufferConnector_ms": 0.0023076534271240234, "ViewRequirementAgentConnector_ms": 0.1445934772491455}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.88809138526358, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.575137990301062, -20.600950309189134, -20.37393111118382, -25.139474192291516, -7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782997727713498, "mean_inference_ms": 0.6326155072174877, "mean_action_processing_ms": 0.09278901576257806, "mean_env_wait_ms": 1.050806266032279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011404275894165039, "StateBufferConnector_ms": 0.0023076534271240234, "ViewRequirementAgentConnector_ms": 0.1445934772491455}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 0, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 888.9205702546492, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 18432, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 579.942, "sample_time_ms": 270.459, "synch_weights_time_ms": 2.393}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 184, "training_iteration": 36, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-11", "timestamp": 1690476551, "time_this_iter_s": 0.9677402973175049, "time_total_s": 34.99290132522583, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 34.99290132522583, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -22.047965915307575, "episode_reward_min": -23.873293588557917, "episode_reward_mean": -22.960629751932746, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.047965915307575, -23.873293588557917], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26063316014308796, "mean_inference_ms": 0.589020492869154, "mean_action_processing_ms": 0.08798595892869206, "mean_env_wait_ms": 0.9920193430314658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010311603546142578, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13730525970458984}}, "episode_reward_max": -22.047965915307575, "episode_reward_min": -23.873293588557917, "episode_reward_mean": -22.960629751932746, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.047965915307575, -23.873293588557917], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26063316014308796, "mean_inference_ms": 0.589020492869154, "mean_action_processing_ms": 0.08798595892869206, "mean_env_wait_ms": 0.9920193430314658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010311603546142578, "StateBufferConnector_ms": 0.0021338462829589844, "ViewRequirementAgentConnector_ms": 0.13730525970458984}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 2.7369495950406417}, "default_policy": {"total_loss": 2.7369495950406417, "policy_loss": 0.005479323866893537, "vf_loss": 2.73010223750407, "vf_loss_unclipped": 5.863295039352124, "vf_explained_var": -0.1429068222641945, "entropy": 7.3151447512209415, "mean_kl_loss": 0.014609118408614563, "gradients_default_optimizer_global_norm": 20.03374853124842, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 18944, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.837050955636517, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2783343749591802, "mean_inference_ms": 0.6326435329206298, "mean_action_processing_ms": 0.09277873196542735, "mean_env_wait_ms": 1.050951559934391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011394023895263672, "StateBufferConnector_ms": 0.002304553985595703, "ViewRequirementAgentConnector_ms": 0.14426398277282715}}, "episode_reward_max": -1.527006257791591, "episode_reward_min": -105.7540731482031, "episode_reward_mean": -27.837050955636517, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.103548873947762, -1.527006257791591, -43.01186989988328, -105.7540731482031, -8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2783343749591802, "mean_inference_ms": 0.6326435329206298, "mean_action_processing_ms": 0.09277873196542735, "mean_env_wait_ms": 1.050951559934391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011394023895263672, "StateBufferConnector_ms": 0.002304553985595703, "ViewRequirementAgentConnector_ms": 0.14426398277282715}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 0, "num_env_steps_sampled": 18944, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 868.6114197283683, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 18944, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 18944, "timers": {"training_iteration_time_ms": 580.597, "sample_time_ms": 270.642, "synch_weights_time_ms": 2.372}, "counters": {"num_env_steps_sampled": 18944, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 188, "training_iteration": 37, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-12", "timestamp": 1690476552, "time_this_iter_s": 0.983515739440918, "time_total_s": 35.97641706466675, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 35.97641706466675, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -28.9190987036536, "episode_reward_min": -31.109323370356993, "episode_reward_mean": -30.014211037005296, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.109323370356993, -28.9190987036536], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606967423655707, "mean_inference_ms": 0.5892667781677767, "mean_action_processing_ms": 0.08800932803039188, "mean_env_wait_ms": 0.992398280216634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010669231414794922, "StateBufferConnector_ms": 0.002205371856689453, "ViewRequirementAgentConnector_ms": 0.1377701759338379}}, "episode_reward_max": -28.9190987036536, "episode_reward_min": -31.109323370356993, "episode_reward_mean": -30.014211037005296, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.109323370356993, -28.9190987036536], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606967423655707, "mean_inference_ms": 0.5892667781677767, "mean_action_processing_ms": 0.08800932803039188, "mean_env_wait_ms": 0.992398280216634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010669231414794922, "StateBufferConnector_ms": 0.002205371856689453, "ViewRequirementAgentConnector_ms": 0.1377701759338379}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.587647124397336}, "default_policy": {"total_loss": 4.587647124397336, "policy_loss": -0.003007600549608469, "vf_loss": 4.590962089423556, "vf_loss_unclipped": 11.92929811758222, "vf_explained_var": -0.12428681645542383, "entropy": 6.882801380008459, "mean_kl_loss": 0.0042969416406322125, "gradients_default_optimizer_global_norm": 18.29724996164441, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.08437500149011612}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3.5503664499671976, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -27.466388960503565, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27825420071751483, "mean_inference_ms": 0.6326814885261167, "mean_action_processing_ms": 0.09278354016335606, "mean_env_wait_ms": 1.0507665332834548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011387825012207031, "StateBufferConnector_ms": 0.002301931381225586, "ViewRequirementAgentConnector_ms": 0.14426064491271973}}, "episode_reward_max": -3.5503664499671976, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -27.466388960503565, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.256793482895032, -31.238085277669164, -13.711175640714648, -3.5503664499671976, -10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27825420071751483, "mean_inference_ms": 0.6326814885261167, "mean_action_processing_ms": 0.09278354016335606, "mean_env_wait_ms": 1.0507665332834548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011387825012207031, "StateBufferConnector_ms": 0.002301931381225586, "ViewRequirementAgentConnector_ms": 0.14426064491271973}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 0, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 889.1288822312399, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 19456, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 580.531, "sample_time_ms": 270.874, "synch_weights_time_ms": 2.406}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 192, "training_iteration": 38, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-13", "timestamp": 1690476553, "time_this_iter_s": 0.9717826843261719, "time_total_s": 36.94819974899292, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 36.94819974899292, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -15.637157802119427, "episode_reward_min": -74.10818568976988, "episode_reward_mean": -44.87267174594466, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-74.10818568976988, -15.637157802119427], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2607494848628118, "mean_inference_ms": 0.5894997626936538, "mean_action_processing_ms": 0.08803574706694818, "mean_env_wait_ms": 0.9934201085892966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01049041748046875, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.13903379440307617}}, "episode_reward_max": -15.637157802119427, "episode_reward_min": -74.10818568976988, "episode_reward_mean": -44.87267174594466, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-74.10818568976988, -15.637157802119427], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2607494848628118, "mean_inference_ms": 0.5894997626936538, "mean_action_processing_ms": 0.08803574706694818, "mean_env_wait_ms": 0.9934201085892966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01049041748046875, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.13903379440307617}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.324607104645111}, "default_policy": {"total_loss": 4.324607104645111, "policy_loss": -0.0016374078559238114, "vf_loss": 4.326856849478645, "vf_loss_unclipped": 10.812697430836124, "vf_explained_var": 0.007369666825979948, "entropy": 6.7922806404531, "mean_kl_loss": 0.004817892545375457, "gradients_default_optimizer_global_norm": 20.266130096511915, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.04218750074505806}}, "num_env_steps_sampled": 19968, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3.6346452233706867, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -27.64790770438459, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782366966290212, "mean_inference_ms": 0.632711157584288, "mean_action_processing_ms": 0.09278220428188576, "mean_env_wait_ms": 1.0507791420374384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011394500732421875, "StateBufferConnector_ms": 0.0023050308227539062, "ViewRequirementAgentConnector_ms": 0.14432692527770996}}, "episode_reward_max": -3.6346452233706867, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -27.64790770438459, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.122236228100927, -46.927889155265404, -25.708191965865304, -9.816603707334572, -33.9769694735584, -17.147974358066076, -45.04574002899573, -20.692001662148986, -19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782366966290212, "mean_inference_ms": 0.632711157584288, "mean_action_processing_ms": 0.09278220428188576, "mean_env_wait_ms": 1.0507791420374384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011394500732421875, "StateBufferConnector_ms": 0.0023050308227539062, "ViewRequirementAgentConnector_ms": 0.14432692527770996}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 0, "num_env_steps_sampled": 19968, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 876.8177613804463, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 19968, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 19968, "timers": {"training_iteration_time_ms": 580.488, "sample_time_ms": 269.718, "synch_weights_time_ms": 2.338}, "counters": {"num_env_steps_sampled": 19968, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 196, "training_iteration": 39, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-14", "timestamp": 1690476554, "time_this_iter_s": 0.9850609302520752, "time_total_s": 37.933260679244995, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 37.933260679244995, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 6.15, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -22.916829613866625, "episode_reward_min": -25.845468627080805, "episode_reward_mean": -24.381149120473715, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.916829613866625, -25.845468627080805], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26076323627576337, "mean_inference_ms": 0.5895598294391973, "mean_action_processing_ms": 0.08804740614927407, "mean_env_wait_ms": 0.9932402684798525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010764598846435547, "StateBufferConnector_ms": 0.0023603439331054688, "ViewRequirementAgentConnector_ms": 0.13742446899414062}}, "episode_reward_max": -22.916829613866625, "episode_reward_min": -25.845468627080805, "episode_reward_mean": -24.381149120473715, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.916829613866625, -25.845468627080805], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26076323627576337, "mean_inference_ms": 0.5895598294391973, "mean_action_processing_ms": 0.08804740614927407, "mean_env_wait_ms": 0.9932402684798525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010764598846435547, "StateBufferConnector_ms": 0.0023603439331054688, "ViewRequirementAgentConnector_ms": 0.13742446899414062}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 7.128748442977667}, "default_policy": {"total_loss": 7.128748442977667, "policy_loss": -0.007296714320546016, "vf_loss": 7.136155725456774, "vf_loss_unclipped": 29.791294016875327, "vf_explained_var": 0.012679851613938808, "entropy": 6.689853549003601, "mean_kl_loss": 0.021163696686471667, "gradients_default_optimizer_global_norm": 13.21309968503192, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.06328125298023224}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -3.242521460809835, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -27.548324629006228, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782480745301855, "mean_inference_ms": 0.632703304394945, "mean_action_processing_ms": 0.09277020221792254, "mean_env_wait_ms": 1.0508497176191613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011683940887451172, "StateBufferConnector_ms": 0.0023615360260009766, "ViewRequirementAgentConnector_ms": 0.14713263511657715}}, "episode_reward_max": -3.242521460809835, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -27.548324629006228, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.630828451549252, -23.412122734261107, -27.864564907996456, -31.731620929827443, -17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782480745301855, "mean_inference_ms": 0.632703304394945, "mean_action_processing_ms": 0.09277020221792254, "mean_env_wait_ms": 1.0508497176191613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011683940887451172, "StateBufferConnector_ms": 0.0023615360260009766, "ViewRequirementAgentConnector_ms": 0.14713263511657715}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 875.7347043970169, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20480, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 581.784, "sample_time_ms": 271.148, "synch_weights_time_ms": 2.333}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 204, "training_iteration": 40, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-15", "timestamp": 1690476555, "time_this_iter_s": 0.9748311042785645, "time_total_s": 38.90809178352356, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 38.90809178352356, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -6.734194728682731, "episode_reward_min": -39.98247399775782, "episode_reward_mean": -23.358334363220276, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.734194728682731, -39.98247399775782], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26079419618291894, "mean_inference_ms": 0.5896644117831893, "mean_action_processing_ms": 0.08805628710150093, "mean_env_wait_ms": 0.9930660892966142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010311603546142578, "StateBufferConnector_ms": 0.002205371856689453, "ViewRequirementAgentConnector_ms": 0.13566017150878906}}, "episode_reward_max": -6.734194728682731, "episode_reward_min": -39.98247399775782, "episode_reward_mean": -23.358334363220276, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.734194728682731, -39.98247399775782], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26079419618291894, "mean_inference_ms": 0.5896644117831893, "mean_action_processing_ms": 0.08805628710150093, "mean_env_wait_ms": 0.9930660892966142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010311603546142578, "StateBufferConnector_ms": 0.002205371856689453, "ViewRequirementAgentConnector_ms": 0.13566017150878906}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 6.017279844927543}, "default_policy": {"total_loss": 6.017279844927543, "policy_loss": -0.009795179998036474, "vf_loss": 6.0275299845670816, "vf_loss_unclipped": 15.369449306133902, "vf_explained_var": -0.04898495972156525, "entropy": 6.794190462678671, "mean_kl_loss": 0.00891576034413788, "gradients_default_optimizer_global_norm": 18.781854392495006, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.06328125298023224}}, "num_env_steps_sampled": 20992, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -2.426396612608353, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -27.34555919463467, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782612092653731, "mean_inference_ms": 0.632663420428046, "mean_action_processing_ms": 0.09275345689082132, "mean_env_wait_ms": 1.0509976916736152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011548995971679688, "StateBufferConnector_ms": 0.002335786819458008, "ViewRequirementAgentConnector_ms": 0.14558625221252441}}, "episode_reward_max": -2.426396612608353, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -27.34555919463467, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.62404472401868, -50.62022077482282, -20.994546784247042, -43.586851739682466, -23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782612092653731, "mean_inference_ms": 0.632663420428046, "mean_action_processing_ms": 0.09275345689082132, "mean_env_wait_ms": 1.0509976916736152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011548995971679688, "StateBufferConnector_ms": 0.002335786819458008, "ViewRequirementAgentConnector_ms": 0.14558625221252441}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20992, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 883.3600631828353, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20992, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20992, "timers": {"training_iteration_time_ms": 582.03, "sample_time_ms": 271.533, "synch_weights_time_ms": 2.337}, "counters": {"num_env_steps_sampled": 20992, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 208, "training_iteration": 41, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-16", "timestamp": 1690476556, "time_this_iter_s": 0.9704315662384033, "time_total_s": 39.87852334976196, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 39.87852334976196, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 6.45, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -9.68528025616977, "episode_reward_min": -24.92439687442263, "episode_reward_mean": -17.3048385652962, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.92439687442263, -9.68528025616977], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2608092082935974, "mean_inference_ms": 0.5897066590615986, "mean_action_processing_ms": 0.08805376222454045, "mean_env_wait_ms": 0.9937765427734608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010502338409423828, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.13617277145385742}}, "episode_reward_max": -9.68528025616977, "episode_reward_min": -24.92439687442263, "episode_reward_mean": -17.3048385652962, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.92439687442263, -9.68528025616977], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2608092082935974, "mean_inference_ms": 0.5897066590615986, "mean_action_processing_ms": 0.08805376222454045, "mean_env_wait_ms": 0.9937765427734608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010502338409423828, "StateBufferConnector_ms": 0.002110004425048828, "ViewRequirementAgentConnector_ms": 0.13617277145385742}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 3.545537296176917}, "default_policy": {"total_loss": 3.545537296176917, "policy_loss": -0.006089546601288021, "vf_loss": 3.552187299967045, "vf_loss_unclipped": 6.2515925566258375, "vf_explained_var": -0.1451620552688837, "entropy": 6.562739439308643, "mean_kl_loss": 0.006699110951331022, "gradients_default_optimizer_global_norm": 25.028400759212673, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.06328125298023224}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -2.426396612608353, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -27.284341588680576, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2781673740127346, "mean_inference_ms": 0.6326157410489951, "mean_action_processing_ms": 0.09274833380590108, "mean_env_wait_ms": 1.0508707227697807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011432647705078125, "StateBufferConnector_ms": 0.0023131370544433594, "ViewRequirementAgentConnector_ms": 0.14402103424072266}}, "episode_reward_max": -2.426396612608353, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -27.284341588680576, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.351951808953334, -31.182956954097353, -43.77430845160186, -34.326077481890934, -32.19786844267549, -37.96114551975567, -40.5972751643165, -5.528967437901819, -16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2781673740127346, "mean_inference_ms": 0.6326157410489951, "mean_action_processing_ms": 0.09274833380590108, "mean_env_wait_ms": 1.0508707227697807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011432647705078125, "StateBufferConnector_ms": 0.0023131370544433594, "ViewRequirementAgentConnector_ms": 0.14402103424072266}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 0, "num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 869.5772579216156, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 21504, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 582.868, "sample_time_ms": 272.174, "synch_weights_time_ms": 2.336}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 212, "training_iteration": 42, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-17", "timestamp": 1690476557, "time_this_iter_s": 0.9861257076263428, "time_total_s": 40.864649057388306, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 40.864649057388306, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 8.9, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -4.017428901338828, "episode_reward_min": -16.911319632363483, "episode_reward_mean": -10.464374266851156, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.911319632363483, -4.017428901338828], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2607862390261613, "mean_inference_ms": 0.5896862073494049, "mean_action_processing_ms": 0.08805340604024797, "mean_env_wait_ms": 0.9930110812090176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010192394256591797, "StateBufferConnector_ms": 0.002086162567138672, "ViewRequirementAgentConnector_ms": 0.13527870178222656}}, "episode_reward_max": -4.017428901338828, "episode_reward_min": -16.911319632363483, "episode_reward_mean": -10.464374266851156, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.911319632363483, -4.017428901338828], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2607862390261613, "mean_inference_ms": 0.5896862073494049, "mean_action_processing_ms": 0.08805340604024797, "mean_env_wait_ms": 0.9930110812090176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010192394256591797, "StateBufferConnector_ms": 0.002086162567138672, "ViewRequirementAgentConnector_ms": 0.13527870178222656}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 3.743345539555321}, "default_policy": {"total_loss": 3.743345539555321, "policy_loss": -0.003971522262872895, "vf_loss": 3.7478048007178586, "vf_loss_unclipped": 6.187043781130342, "vf_explained_var": 0.03929253714159131, "entropy": 6.302370272576809, "mean_kl_loss": 0.007232256961856365, "gradients_default_optimizer_global_norm": 20.128685219213367, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.06328125298023224}}, "num_env_steps_sampled": 22016, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -2.426396612608353, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -26.888767061787224, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27810468403570776, "mean_inference_ms": 0.632460972204539, "mean_action_processing_ms": 0.09272017210977332, "mean_env_wait_ms": 1.0507225842216004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011463165283203125, "StateBufferConnector_ms": 0.002312898635864258, "ViewRequirementAgentConnector_ms": 0.14433670043945312}}, "episode_reward_max": -2.426396612608353, "episode_reward_min": -74.57801045491615, "episode_reward_mean": -26.888767061787224, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.413320741171944, -74.57801045491615, -50.39801959616495, -43.72647712706993, -23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27810468403570776, "mean_inference_ms": 0.632460972204539, "mean_action_processing_ms": 0.09272017210977332, "mean_env_wait_ms": 1.0507225842216004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011463165283203125, "StateBufferConnector_ms": 0.002312898635864258, "ViewRequirementAgentConnector_ms": 0.14433670043945312}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 0, "num_env_steps_sampled": 22016, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 874.0807929509681, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 22016, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 22016, "timers": {"training_iteration_time_ms": 583.221, "sample_time_ms": 272.833, "synch_weights_time_ms": 2.33}, "counters": {"num_env_steps_sampled": 22016, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 220, "training_iteration": 43, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-18", "timestamp": 1690476558, "time_this_iter_s": 0.969801664352417, "time_total_s": 41.83445072174072, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 41.83445072174072, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -17.05236378325784, "episode_reward_min": -32.140926948481045, "episode_reward_mean": -24.596645365869442, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.140926948481045, -17.05236378325784], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.260863679604779, "mean_inference_ms": 0.5899543261584904, "mean_action_processing_ms": 0.08808551979476709, "mean_env_wait_ms": 0.9943691251928353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010776519775390625, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.1368880271911621}}, "episode_reward_max": -17.05236378325784, "episode_reward_min": -32.140926948481045, "episode_reward_mean": -24.596645365869442, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.140926948481045, -17.05236378325784], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.260863679604779, "mean_inference_ms": 0.5899543261584904, "mean_action_processing_ms": 0.08808551979476709, "mean_env_wait_ms": 0.9943691251928353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010776519775390625, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.1368880271911621}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.597937624552287}, "default_policy": {"total_loss": 4.597937624552287, "policy_loss": -0.0022349007485900074, "vf_loss": 4.600516995124053, "vf_loss_unclipped": 13.482349669269752, "vf_explained_var": -0.3736651735380292, "entropy": 6.6606942638754845, "mean_kl_loss": 0.010344770211304422, "gradients_default_optimizer_global_norm": 26.767792548052967, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.06328125298023224}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -2.426396612608353, "episode_reward_min": -61.47859161895012, "episode_reward_mean": -25.96515902970041, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27810521905259433, "mean_inference_ms": 0.632351737179615, "mean_action_processing_ms": 0.0926963758948581, "mean_env_wait_ms": 1.0508645721019194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011467218399047852, "StateBufferConnector_ms": 0.002312183380126953, "ViewRequirementAgentConnector_ms": 0.14437460899353027}}, "episode_reward_max": -2.426396612608353, "episode_reward_min": -61.47859161895012, "episode_reward_mean": -25.96515902970041, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.99239413178773, -5.0055781230281475, -22.3192712175735, -37.976015599214804, -7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27810521905259433, "mean_inference_ms": 0.632351737179615, "mean_action_processing_ms": 0.0926963758948581, "mean_env_wait_ms": 1.0508645721019194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011467218399047852, "StateBufferConnector_ms": 0.002312183380126953, "ViewRequirementAgentConnector_ms": 0.14437460899353027}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 0, "num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 875.0927148944563, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 22528, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 583.683, "sample_time_ms": 273.341, "synch_weights_time_ms": 2.306}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 224, "training_iteration": 44, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-19", "timestamp": 1690476559, "time_this_iter_s": 0.991307258605957, "time_total_s": 42.82575798034668, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 42.82575798034668, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 6.800000000000001, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -4.001991107852546, "episode_reward_min": -32.253290614195386, "episode_reward_mean": -18.127640861023966, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.001991107852546, -32.253290614195386], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26082923684884624, "mean_inference_ms": 0.5899222608858076, "mean_action_processing_ms": 0.08808328183329565, "mean_env_wait_ms": 0.9946885631821074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010251998901367188, "StateBufferConnector_ms": 0.0021219253540039062, "ViewRequirementAgentConnector_ms": 0.13604164123535156}}, "episode_reward_max": -4.001991107852546, "episode_reward_min": -32.253290614195386, "episode_reward_mean": -18.127640861023966, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.001991107852546, -32.253290614195386], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26082923684884624, "mean_inference_ms": 0.5899222608858076, "mean_action_processing_ms": 0.08808328183329565, "mean_env_wait_ms": 0.9946885631821074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010251998901367188, "StateBufferConnector_ms": 0.0021219253540039062, "ViewRequirementAgentConnector_ms": 0.13604164123535156}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 3.7759647788479924}, "default_policy": {"total_loss": 3.7759647788479924, "policy_loss": -0.006209095910890028, "vf_loss": 3.7828929718816653, "vf_loss_unclipped": 4.511153682717122, "vf_explained_var": -0.5087971142493188, "entropy": 6.57241278514266, "mean_kl_loss": 0.004216360253167295, "gradients_default_optimizer_global_norm": 31.502165375975892, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.03164062649011612}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -2.426396612608353, "episode_reward_min": -61.47859161895012, "episode_reward_mean": -25.603534115942683, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27802974708425426, "mean_inference_ms": 0.6323070849370341, "mean_action_processing_ms": 0.09269521714773063, "mean_env_wait_ms": 1.0507293830921964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011472463607788086, "StateBufferConnector_ms": 0.00231170654296875, "ViewRequirementAgentConnector_ms": 0.14450359344482422}}, "episode_reward_max": -2.426396612608353, "episode_reward_min": -61.47859161895012, "episode_reward_mean": -25.603534115942683, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.230245380829157, -28.722105910071114, -29.66726625104946, -19.996741637988798, -3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27802974708425426, "mean_inference_ms": 0.6323070849370341, "mean_action_processing_ms": 0.09269521714773063, "mean_env_wait_ms": 1.0507293830921964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011472463607788086, "StateBufferConnector_ms": 0.00231170654296875, "ViewRequirementAgentConnector_ms": 0.14450359344482422}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 0, "num_env_steps_sampled": 23040, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 876.1959903170936, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 23040, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 23040, "timers": {"training_iteration_time_ms": 583.323, "sample_time_ms": 272.984, "synch_weights_time_ms": 2.316}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 228, "training_iteration": 45, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-20", "timestamp": 1690476560, "time_this_iter_s": 0.9778671264648438, "time_total_s": 43.80362510681152, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 43.80362510681152, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 7.9, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -12.388733761419214, "episode_reward_min": -26.667118750873833, "episode_reward_mean": -19.52792625614652, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.388733761419214, -26.667118750873833], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26082287740608934, "mean_inference_ms": 0.5899314426388537, "mean_action_processing_ms": 0.08808279954769109, "mean_env_wait_ms": 0.9940749030439197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010263919830322266, "StateBufferConnector_ms": 0.0020742416381835938, "ViewRequirementAgentConnector_ms": 0.13655424118041992}}, "episode_reward_max": -12.388733761419214, "episode_reward_min": -26.667118750873833, "episode_reward_mean": -19.52792625614652, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.388733761419214, -26.667118750873833], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26082287740608934, "mean_inference_ms": 0.5899314426388537, "mean_action_processing_ms": 0.08808279954769109, "mean_env_wait_ms": 0.9940749030439197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010263919830322266, "StateBufferConnector_ms": 0.0020742416381835938, "ViewRequirementAgentConnector_ms": 0.13655424118041992}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 2.599371793679893}, "default_policy": {"total_loss": 2.599371793679893, "policy_loss": 0.0002935100346803665, "vf_loss": 2.5996863981708884, "vf_loss_unclipped": 6.784146535210311, "vf_explained_var": 0.09181352285668254, "entropy": 6.974408283829689, "mean_kl_loss": 0.013844766604298897, "gradients_default_optimizer_global_norm": 18.997896073851734, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.03164062649011612}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -2.426396612608353, "episode_reward_min": -61.47859161895012, "episode_reward_mean": -25.585883536099278, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459, -34.711743116372986, -13.826054604904142, -24.121841348501857, -11.191662125818127], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2780003534607421, "mean_inference_ms": 0.6322437288530023, "mean_action_processing_ms": 0.09268544701207655, "mean_env_wait_ms": 1.0507882901109706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01148080825805664, "StateBufferConnector_ms": 0.0023131370544433594, "ViewRequirementAgentConnector_ms": 0.14450335502624512}}, "episode_reward_max": -2.426396612608353, "episode_reward_min": -61.47859161895012, "episode_reward_mean": -25.585883536099278, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8086669193543456, -28.230488068203854, -44.205401866824374, -24.67521557593206, -29.51039966831182, -39.6381641034567, -52.94084348261502, -3.6346452233706867, -21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459, -34.711743116372986, -13.826054604904142, -24.121841348501857, -11.191662125818127], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2780003534607421, "mean_inference_ms": 0.6322437288530023, "mean_action_processing_ms": 0.09268544701207655, "mean_env_wait_ms": 1.0507882901109706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01148080825805664, "StateBufferConnector_ms": 0.0023131370544433594, "ViewRequirementAgentConnector_ms": 0.14450335502624512}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 0, "num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 863.3995598337435, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 23552, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 585.025, "sample_time_ms": 274.779, "synch_weights_time_ms": 2.353}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 232, "training_iteration": 46, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-21", "timestamp": 1690476561, "time_this_iter_s": 0.9786479473114014, "time_total_s": 44.782273054122925, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 44.782273054122925, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -14.113240871107207, "episode_reward_min": -21.055611194790583, "episode_reward_mean": -17.584426032948894, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.055611194790583, -14.113240871107207], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606389066308448, "mean_inference_ms": 0.5895902775485596, "mean_action_processing_ms": 0.08802225761953256, "mean_env_wait_ms": 0.9935320647342853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010085105895996094, "StateBufferConnector_ms": 0.0020623207092285156, "ViewRequirementAgentConnector_ms": 0.13213157653808594}}, "episode_reward_max": -14.113240871107207, "episode_reward_min": -21.055611194790583, "episode_reward_mean": -17.584426032948894, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.055611194790583, -14.113240871107207], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606389066308448, "mean_inference_ms": 0.5895902775485596, "mean_action_processing_ms": 0.08802225761953256, "mean_env_wait_ms": 0.9935320647342853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010085105895996094, "StateBufferConnector_ms": 0.0020623207092285156, "ViewRequirementAgentConnector_ms": 0.13213157653808594}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.551302523701452}, "default_policy": {"total_loss": 4.551302523701452, "policy_loss": 0.027518519382283557, "vf_loss": 4.524261623853818, "vf_loss_unclipped": 112.83037982159294, "vf_explained_var": 0.1163618266582489, "entropy": 7.431504141539335, "mean_kl_loss": 0.02013556619613155, "gradients_default_optimizer_global_norm": 18.13563913339749, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.04746093973517418}}, "num_env_steps_sampled": 24064, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -2.426396612608353, "episode_reward_min": -87.98211706738047, "episode_reward_mean": -25.999443516453457, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459, -34.711743116372986, -13.826054604904142, -24.121841348501857, -11.191662125818127, -25.053938319022855, -20.383651871971075, -3.653468158335426, -31.78476186236377, -24.856482284988246, -49.024874239688806, -25.26052913973657, -87.98211706738047], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27799689361913915, "mean_inference_ms": 0.632139005784777, "mean_action_processing_ms": 0.0926689838182617, "mean_env_wait_ms": 1.050930875472429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011728286743164062, "StateBufferConnector_ms": 0.002368450164794922, "ViewRequirementAgentConnector_ms": 0.14777398109436035}}, "episode_reward_max": -2.426396612608353, "episode_reward_min": -87.98211706738047, "episode_reward_mean": -25.999443516453457, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.962423543079893, -28.52637543064499, -30.78836997253329, -45.298828190638424, -45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459, -34.711743116372986, -13.826054604904142, -24.121841348501857, -11.191662125818127, -25.053938319022855, -20.383651871971075, -3.653468158335426, -31.78476186236377, -24.856482284988246, -49.024874239688806, -25.26052913973657, -87.98211706738047], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27799689361913915, "mean_inference_ms": 0.632139005784777, "mean_action_processing_ms": 0.0926689838182617, "mean_env_wait_ms": 1.050930875472429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011728286743164062, "StateBufferConnector_ms": 0.002368450164794922, "ViewRequirementAgentConnector_ms": 0.14777398109436035}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24064, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 869.3780056013065, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24064, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24064, "timers": {"training_iteration_time_ms": 584.973, "sample_time_ms": 274.975, "synch_weights_time_ms": 2.358}, "counters": {"num_env_steps_sampled": 24064, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 240, "training_iteration": 47, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-22", "timestamp": 1690476562, "time_this_iter_s": 0.9695155620574951, "time_total_s": 45.75178861618042, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 45.75178861618042, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 9.7}}
{"evaluation": {"sampler_results": {"episode_reward_max": -10.584024583978604, "episode_reward_min": -20.004258269691356, "episode_reward_mean": -15.29414142683498, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.004258269691356, -10.584024583978604], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606263968761036, "mean_inference_ms": 0.5896495985570096, "mean_action_processing_ms": 0.08802768551127486, "mean_env_wait_ms": 0.9933883554549804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010478496551513672, "StateBufferConnector_ms": 0.0020623207092285156, "ViewRequirementAgentConnector_ms": 0.1343369483947754}}, "episode_reward_max": -10.584024583978604, "episode_reward_min": -20.004258269691356, "episode_reward_mean": -15.29414142683498, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.004258269691356, -10.584024583978604], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606263968761036, "mean_inference_ms": 0.5896495985570096, "mean_action_processing_ms": 0.08802768551127486, "mean_env_wait_ms": 0.9933883554549804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010478496551513672, "StateBufferConnector_ms": 0.0020623207092285156, "ViewRequirementAgentConnector_ms": 0.1343369483947754}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.091739437862998}, "default_policy": {"total_loss": 5.091739437862998, "policy_loss": 0.0013976993504911661, "vf_loss": 5.090709736250574, "vf_loss_unclipped": 9.003918308444554, "vf_explained_var": -0.07851182064041495, "entropy": 6.3146346136927605, "mean_kl_loss": 0.012204141239294586, "gradients_default_optimizer_global_norm": 25.743130176328123, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.04746093973517418}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -2.426396612608353, "episode_reward_min": -87.98211706738047, "episode_reward_mean": -25.866659317558298, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459, -34.711743116372986, -13.826054604904142, -24.121841348501857, -11.191662125818127, -25.053938319022855, -20.383651871971075, -3.653468158335426, -31.78476186236377, -24.856482284988246, -49.024874239688806, -25.26052913973657, -87.98211706738047, -39.470216299564704, -21.770128630331282, -37.60598497137473, -14.451247346109708], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27801714064228916, "mean_inference_ms": 0.6320449116377558, "mean_action_processing_ms": 0.09264993836790124, "mean_env_wait_ms": 1.0511444431612746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011606693267822266, "StateBufferConnector_ms": 0.0023450851440429688, "ViewRequirementAgentConnector_ms": 0.1462116241455078}}, "episode_reward_max": -2.426396612608353, "episode_reward_min": -87.98211706738047, "episode_reward_mean": -25.866659317558298, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.364063687650415, -26.55918067951798, -17.927449773904698, -14.641008062831805, -13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459, -34.711743116372986, -13.826054604904142, -24.121841348501857, -11.191662125818127, -25.053938319022855, -20.383651871971075, -3.653468158335426, -31.78476186236377, -24.856482284988246, -49.024874239688806, -25.26052913973657, -87.98211706738047, -39.470216299564704, -21.770128630331282, -37.60598497137473, -14.451247346109708], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27801714064228916, "mean_inference_ms": 0.6320449116377558, "mean_action_processing_ms": 0.09264993836790124, "mean_env_wait_ms": 1.0511444431612746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011606693267822266, "StateBufferConnector_ms": 0.0023450851440429688, "ViewRequirementAgentConnector_ms": 0.1462116241455078}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 877.4285847367531, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24576, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 585.741, "sample_time_ms": 276.645, "synch_weights_time_ms": 2.409}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 244, "training_iteration": 48, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-23", "timestamp": 1690476563, "time_this_iter_s": 0.9736828804016113, "time_total_s": 46.72547149658203, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 46.72547149658203, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 9.7}}
{"evaluation": {"sampler_results": {"episode_reward_max": -11.111832795423055, "episode_reward_min": -26.59303188654415, "episode_reward_mean": -18.852432340983604, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.111832795423055, -26.59303188654415], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606201629202751, "mean_inference_ms": 0.589683315922029, "mean_action_processing_ms": 0.08802218846357206, "mean_env_wait_ms": 0.993682296771612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010228157043457031, "StateBufferConnector_ms": 0.0020384788513183594, "ViewRequirementAgentConnector_ms": 0.1368880271911621}}, "episode_reward_max": -11.111832795423055, "episode_reward_min": -26.59303188654415, "episode_reward_mean": -18.852432340983604, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.111832795423055, -26.59303188654415], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606201629202751, "mean_inference_ms": 0.589683315922029, "mean_action_processing_ms": 0.08802218846357206, "mean_env_wait_ms": 0.993682296771612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010228157043457031, "StateBufferConnector_ms": 0.0020384788513183594, "ViewRequirementAgentConnector_ms": 0.1368880271911621}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 4.8105249523650855}, "default_policy": {"total_loss": 4.8105249523650855, "policy_loss": -0.0038387883687391877, "vf_loss": 4.814972469815984, "vf_loss_unclipped": 8.708776064449921, "vf_explained_var": -0.17455664789304137, "entropy": 6.150311637669802, "mean_kl_loss": 0.006611199394114919, "gradients_default_optimizer_global_norm": 32.55625396966934, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.04746093973517418}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -2.426396612608353, "episode_reward_min": -87.98211706738047, "episode_reward_mean": -25.390041151199366, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459, -34.711743116372986, -13.826054604904142, -24.121841348501857, -11.191662125818127, -25.053938319022855, -20.383651871971075, -3.653468158335426, -31.78476186236377, -24.856482284988246, -49.024874239688806, -25.26052913973657, -87.98211706738047, -39.470216299564704, -21.770128630331282, -37.60598497137473, -14.451247346109708, -9.308553454791353, -38.7701000771643, -4.778040803726396, -3.9731912323301573], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2779655013426428, "mean_inference_ms": 0.6320213488648105, "mean_action_processing_ms": 0.09265262518126009, "mean_env_wait_ms": 1.0511006760340709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011481285095214844, "StateBufferConnector_ms": 0.002318143844604492, "ViewRequirementAgentConnector_ms": 0.14464688301086426}}, "episode_reward_max": -2.426396612608353, "episode_reward_min": -87.98211706738047, "episode_reward_mean": -25.390041151199366, "episode_len_mean": 100.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.378116610827282, -22.06798626603983, -25.795336133929418, -25.14178217889093, -43.7874617464275, -61.47859161895012, -33.776227722949095, -19.46993230315966, -45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459, -34.711743116372986, -13.826054604904142, -24.121841348501857, -11.191662125818127, -25.053938319022855, -20.383651871971075, -3.653468158335426, -31.78476186236377, -24.856482284988246, -49.024874239688806, -25.26052913973657, -87.98211706738047, -39.470216299564704, -21.770128630331282, -37.60598497137473, -14.451247346109708, -9.308553454791353, -38.7701000771643, -4.778040803726396, -3.9731912323301573], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2779655013426428, "mean_inference_ms": 0.6320213488648105, "mean_action_processing_ms": 0.09265262518126009, "mean_env_wait_ms": 1.0511006760340709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011481285095214844, "StateBufferConnector_ms": 0.002318143844604492, "ViewRequirementAgentConnector_ms": 0.14464688301086426}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 0, "num_env_steps_sampled": 25088, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 891.6188633527117, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 25088, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 25088, "timers": {"training_iteration_time_ms": 584.772, "sample_time_ms": 276.127, "synch_weights_time_ms": 2.392}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 248, "training_iteration": 49, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-24", "timestamp": 1690476564, "time_this_iter_s": 0.9685344696044922, "time_total_s": 47.69400596618652, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 47.69400596618652, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 8.2, "ram_util_percent": 9.6}}
{"evaluation": {"sampler_results": {"episode_reward_max": -20.363113147941238, "episode_reward_min": -28.914276878209485, "episode_reward_mean": -24.638695013075363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.363113147941238, -28.914276878209485], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606667681773082, "mean_inference_ms": 0.5898189811679843, "mean_action_processing_ms": 0.08803886743131106, "mean_env_wait_ms": 0.9948013901841627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010395050048828125, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.138092041015625}}, "episode_reward_max": -20.363113147941238, "episode_reward_min": -28.914276878209485, "episode_reward_mean": -24.638695013075363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.363113147941238, -28.914276878209485], "episode_lengths": [100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2606667681773082, "mean_inference_ms": 0.5898189811679843, "mean_action_processing_ms": 0.08803886743131106, "mean_env_wait_ms": 0.9948013901841627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010395050048828125, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.138092041015625}, "num_agent_steps_sampled_this_iter": 200, "num_env_steps_sampled_this_iter": 200, "timesteps_this_iter": 200, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 32.0, "num_env_steps_trained": 512.0, "total_loss": 5.127268993295729}, "default_policy": {"total_loss": 5.127268993295729, "policy_loss": 0.0019881065818481147, "vf_loss": 5.125605690976954, "vf_loss_unclipped": 13.234791916547692, "vf_explained_var": -0.10953231481835246, "entropy": 5.955024514347315, "mean_kl_loss": 0.011977924677466945, "gradients_default_optimizer_global_norm": 25.29444080637768, "curr_lr": 0.00015, "curr_entropy_coeff": 0.00015, "curr_kl_coeff": 0.04746093973517418}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -2.426396612608353, "episode_reward_min": -87.98211706738047, "episode_reward_mean": -24.52298371348375, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459, -34.711743116372986, -13.826054604904142, -24.121841348501857, -11.191662125818127, -25.053938319022855, -20.383651871971075, -3.653468158335426, -31.78476186236377, -24.856482284988246, -49.024874239688806, -25.26052913973657, -87.98211706738047, -39.470216299564704, -21.770128630331282, -37.60598497137473, -14.451247346109708, -9.308553454791353, -38.7701000771643, -4.778040803726396, -3.9731912323301573, -12.200323285543305, -40.949334634257156, -18.591248279628115, -6.652242563992142, -5.9593372559599445, -18.811257482019833, -27.11307297558826, -27.912874332623048], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27796426469179913, "mean_inference_ms": 0.6319404041236263, "mean_action_processing_ms": 0.09264056517973486, "mean_env_wait_ms": 1.0513138143867153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011495113372802734, "StateBufferConnector_ms": 0.0023200511932373047, "ViewRequirementAgentConnector_ms": 0.14472246170043945}}, "episode_reward_max": -2.426396612608353, "episode_reward_min": -87.98211706738047, "episode_reward_mean": -24.52298371348375, "episode_len_mean": 100.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.55835937202678, -19.771101296423204, -40.999341452186385, -17.512544506794267, -32.01581733244333, -36.32584718271234, -13.586821951322845, -5.747743575498065, -18.74666444429566, -32.45527624236755, -40.88308372771822, -25.28100493926862, -19.32725565723113, -9.078541138360661, -33.375966757581985, -15.064530091521364, -26.37252946077176, -5.106305452118283, -31.21950303338218, -37.601681823202014, -19.947357469621263, -20.886643706871872, -19.936871786778244, -20.903630189623083, -41.93982552866093, -59.58340521522722, -17.822521472311816, -23.461187198155596, -27.14010644908823, -23.016300267087065, -7.317031472409433, -25.112012451675323, -41.402495152630635, -19.633180365978653, -41.53955088693891, -17.75507226098192, -4.484933552567607, -14.823146571002887, -39.343739497845974, -16.25647561793195, -42.25583611776139, -39.822391113888166, -26.331297664376198, -10.598144117050293, -9.47257531831378, -44.31186089152652, -23.444672357773285, -3.242521460809835, -4.894677988610423, -35.8837247115802, -2.426396612608353, -39.15779427367926, -19.37828743057541, -44.254473766598245, -34.08194111327041, -28.989201116918036, -11.352295927613055, -25.868502586601313, -32.84045939984198, -27.530847542953197, -28.113555886140013, -14.014565794588915, -31.67006160273582, -37.97280983138271, -45.99305776288196, -10.568625205776513, -22.85211670898896, -13.341225032994188, -8.35626860588875, -10.528839760013605, -11.73441545561551, -22.51124387431459, -34.711743116372986, -13.826054604904142, -24.121841348501857, -11.191662125818127, -25.053938319022855, -20.383651871971075, -3.653468158335426, -31.78476186236377, -24.856482284988246, -49.024874239688806, -25.26052913973657, -87.98211706738047, -39.470216299564704, -21.770128630331282, -37.60598497137473, -14.451247346109708, -9.308553454791353, -38.7701000771643, -4.778040803726396, -3.9731912323301573, -12.200323285543305, -40.949334634257156, -18.591248279628115, -6.652242563992142, -5.9593372559599445, -18.811257482019833, -27.11307297558826, -27.912874332623048], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27796426469179913, "mean_inference_ms": 0.6319404041236263, "mean_action_processing_ms": 0.09264056517973486, "mean_env_wait_ms": 1.0513138143867153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011495113372802734, "StateBufferConnector_ms": 0.0023200511932373047, "ViewRequirementAgentConnector_ms": 0.14472246170043945}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 0, "num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 920.875560141029, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 25600, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 581.906, "sample_time_ms": 274.908, "synch_weights_time_ms": 2.442}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 0}, "done": true, "episodes_total": 256, "training_iteration": 50, "trial_id": "6abf4_00000", "date": "2023-07-27_17-49-25", "timestamp": 1690476565, "time_this_iter_s": 0.9601585865020752, "time_total_s": 48.6541645526886, "pid": 23080, "hostname": "lnx-grid-34", "node_ip": "158.125.237.153", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "Gymnasium_Pick_Place_0_Dense", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00015, "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fbbb7260e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 2, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 32, "num_sgd_iter": 8, "shuffle_sequences": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00015, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.99, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 48.6541645526886, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 9.6}}
